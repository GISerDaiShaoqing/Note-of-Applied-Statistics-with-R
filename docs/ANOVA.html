<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 8 章 ANOVA | 应用统计学与R语言实现学习笔记</title>
  <meta name="description" content="第 8 章 ANOVA | 应用统计学与R语言实现学习笔记" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="第 8 章 ANOVA | 应用统计学与R语言实现学习笔记" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.jpg" />
  
  <meta name="github-repo" content="GISerDaiShaoqing/Note-of-Applied-Statistics-with-R-Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 8 章 ANOVA | 应用统计学与R语言实现学习笔记" />
  
  
  <meta name="twitter:image" content="images/cover.jpg" />

<meta name="author" content="戴劭勍" />


<meta name="date" content="2021-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="goodness.html"/>
<link rel="next" href="regression.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">中文书示例</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#致谢"><i class="fa fa-check"></i>致谢</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#从问题说起"><i class="fa fa-check"></i><b>1.1</b> 从问题说起</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#统计学及其研究过程"><i class="fa fa-check"></i><b>1.2</b> 统计学及其研究过程</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#统计方法及其应用领域"><i class="fa fa-check"></i><b>1.3</b> 统计方法及其应用领域</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#统计数据类型"><i class="fa fa-check"></i><b>1.4</b> 统计数据类型</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#统计学中的几个基本概念"><i class="fa fa-check"></i><b>1.5</b> 统计学中的几个基本概念</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datacollec.html"><a href="datacollec.html"><i class="fa fa-check"></i><b>2</b> Data Collection</a><ul>
<li class="chapter" data-level="2.1" data-path="datacollec.html"><a href="datacollec.html#数据来源"><i class="fa fa-check"></i><b>2.1</b> 数据来源</a></li>
<li class="chapter" data-level="2.2" data-path="datacollec.html"><a href="datacollec.html#调查设计"><i class="fa fa-check"></i><b>2.2</b> 调查设计</a></li>
<li class="chapter" data-level="2.3" data-path="datacollec.html"><a href="datacollec.html#数据质量"><i class="fa fa-check"></i><b>2.3</b> 数据质量</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptive.html"><a href="descriptive.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="descriptive.html"><a href="descriptive.html#数据的预处理"><i class="fa fa-check"></i><b>3.1</b> 数据的预处理</a></li>
<li class="chapter" data-level="3.2" data-path="descriptive.html"><a href="descriptive.html#数据的整理与展示"><i class="fa fa-check"></i><b>3.2</b> 数据的整理与展示</a></li>
<li class="chapter" data-level="3.3" data-path="descriptive.html"><a href="descriptive.html#数据的概括性度量"><i class="fa fa-check"></i><b>3.3</b> 数据的概括性度量</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>4</b> Sampling And Sample Distribution</a><ul>
<li class="chapter" data-level="4.1" data-path="sampling.html"><a href="sampling.html#抽样方法"><i class="fa fa-check"></i><b>4.1</b> 抽样方法</a></li>
<li class="chapter" data-level="4.2" data-path="sampling.html"><a href="sampling.html#正态分布"><i class="fa fa-check"></i><b>4.2</b> 正态分布</a></li>
<li class="chapter" data-level="4.3" data-path="sampling.html"><a href="sampling.html#三种不同性质的分布"><i class="fa fa-check"></i><b>4.3</b> 三种不同性质的分布</a></li>
<li class="chapter" data-level="4.4" data-path="sampling.html"><a href="sampling.html#一个总体样本统计量的抽样分布"><i class="fa fa-check"></i><b>4.4</b> 一个总体样本统计量的抽样分布</a></li>
<li class="chapter" data-level="4.5" data-path="sampling.html"><a href="sampling.html#两个总体样本统计量的抽样分布"><i class="fa fa-check"></i><b>4.5</b> 两个总体样本统计量的抽样分布</a></li>
<li class="chapter" data-level="4.6" data-path="sampling.html"><a href="sampling.html#附录"><i class="fa fa-check"></i><b>4.6</b> 附录</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>5</b> Estimation</a><ul>
<li class="chapter" data-level="5.1" data-path="estimation.html"><a href="estimation.html#参数估计的一般问题"><i class="fa fa-check"></i><b>5.1</b> 参数估计的一般问题</a></li>
<li class="chapter" data-level="5.2" data-path="estimation.html"><a href="estimation.html#区间估计-confidence-intervals"><i class="fa fa-check"></i><b>5.2</b> 区间估计 Confidence Intervals</a></li>
<li class="chapter" data-level="5.3" data-path="estimation.html"><a href="estimation.html#样本容量的确定"><i class="fa fa-check"></i><b>5.3</b> 样本容量的确定</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hypothesis.html"><a href="hypothesis.html"><i class="fa fa-check"></i><b>6</b> Hypothesis Test</a><ul>
<li class="chapter" data-level="6.1" data-path="hypothesis.html"><a href="hypothesis.html#基本思想"><i class="fa fa-check"></i><b>6.1</b> 基本思想</a></li>
<li class="chapter" data-level="6.2" data-path="hypothesis.html"><a href="hypothesis.html#原假设和备择假设"><i class="fa fa-check"></i><b>6.2</b> 原假设和备择假设</a></li>
<li class="chapter" data-level="6.3" data-path="hypothesis.html"><a href="hypothesis.html#第一类错误和第二类错误"><i class="fa fa-check"></i><b>6.3</b> 第一类错误和第二类错误</a></li>
<li class="chapter" data-level="6.4" data-path="hypothesis.html"><a href="hypothesis.html#统计量与拒绝域"><i class="fa fa-check"></i><b>6.4</b> 统计量与拒绝域</a></li>
<li class="chapter" data-level="6.5" data-path="hypothesis.html"><a href="hypothesis.html#利用p值进行决策"><i class="fa fa-check"></i><b>6.5</b> 利用p值进行决策</a></li>
<li class="chapter" data-level="6.6" data-path="hypothesis.html"><a href="hypothesis.html#一个总体参数的检验"><i class="fa fa-check"></i><b>6.6</b> 一个总体参数的检验</a></li>
<li class="chapter" data-level="6.7" data-path="hypothesis.html"><a href="hypothesis.html#两个总体参数的检验"><i class="fa fa-check"></i><b>6.7</b> 两个总体参数的检验</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="goodness.html"><a href="goodness.html"><i class="fa fa-check"></i><b>7</b> Goodness of Fit</a><ul>
<li class="chapter" data-level="7.1" data-path="goodness.html"><a href="goodness.html#多项分布"><i class="fa fa-check"></i><b>7.1</b> 多项分布</a></li>
<li class="chapter" data-level="7.2" data-path="goodness.html"><a href="goodness.html#独立性"><i class="fa fa-check"></i><b>7.2</b> 独立性</a></li>
<li class="chapter" data-level="7.3" data-path="goodness.html"><a href="goodness.html#概率分布"><i class="fa fa-check"></i><b>7.3</b> 概率分布</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ANOVA.html"><a href="ANOVA.html"><i class="fa fa-check"></i><b>8</b> ANOVA</a><ul>
<li class="chapter" data-level="8.1" data-path="ANOVA.html"><a href="ANOVA.html#方差分析的引论"><i class="fa fa-check"></i><b>8.1</b> 方差分析的引论</a><ul>
<li class="chapter" data-level="8.1.1" data-path="ANOVA.html"><a href="ANOVA.html#方差分析的部分概念"><i class="fa fa-check"></i><b>8.1.1</b> 方差分析的部分概念</a></li>
<li class="chapter" data-level="8.1.2" data-path="ANOVA.html"><a href="ANOVA.html#方差分析的基本思想和原理"><i class="fa fa-check"></i><b>8.1.2</b> 方差分析的基本思想和原理</a></li>
<li class="chapter" data-level="8.1.3" data-path="ANOVA.html"><a href="ANOVA.html#方差分析的基本假定"><i class="fa fa-check"></i><b>8.1.3</b> 方差分析的基本假定</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ANOVA.html"><a href="ANOVA.html#单因子方差分析one-way-anova"><i class="fa fa-check"></i><b>8.2</b> 单因子方差分析（One-way ANOVA)</a></li>
<li class="chapter" data-level="8.3" data-path="ANOVA.html"><a href="ANOVA.html#方差分析中的多重比较"><i class="fa fa-check"></i><b>8.3</b> 方差分析中的多重比较</a></li>
<li class="chapter" data-level="8.4" data-path="ANOVA.html"><a href="ANOVA.html#双因子方差分析two-way-anova"><i class="fa fa-check"></i><b>8.4</b> 双因子方差分析（Two-way ANOVA）</a><ul>
<li class="chapter" data-level="8.4.1" data-path="ANOVA.html"><a href="ANOVA.html#双因子方差分析的基本假定"><i class="fa fa-check"></i><b>8.4.1</b> 双因子方差分析的基本假定</a></li>
<li class="chapter" data-level="8.4.2" data-path="ANOVA.html"><a href="ANOVA.html#无交互作用双因子方差分析"><i class="fa fa-check"></i><b>8.4.2</b> 无交互作用双因子方差分析</a></li>
<li class="chapter" data-level="8.4.3" data-path="ANOVA.html"><a href="ANOVA.html#有交互作用双因子方差分析"><i class="fa fa-check"></i><b>8.4.3</b> 有交互作用双因子方差分析</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ANOVA.html"><a href="ANOVA.html#实验设计初步"><i class="fa fa-check"></i><b>8.5</b> 实验设计初步</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Linear Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#变量间的关系"><i class="fa fa-check"></i><b>9.1</b> 变量间的关系</a></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#回归分析和简单线性回归分析"><i class="fa fa-check"></i><b>9.2</b> 回归分析和简单线性回归分析</a><ul>
<li class="chapter" data-level="9.2.1" data-path="regression.html"><a href="regression.html#回归分析"><i class="fa fa-check"></i><b>9.2.1</b> 回归分析</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#简单线性回归分析"><i class="fa fa-check"></i><b>9.2.2</b> 简单线性回归分析</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#利用回归方程进行估计和预测"><i class="fa fa-check"></i><b>9.3</b> 利用回归方程进行估计和预测</a></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#残差分析"><i class="fa fa-check"></i><b>9.4</b> 残差分析</a></li>
<li class="chapter" data-level="9.5" data-path="regression.html"><a href="regression.html#多元线性回归multiple-regression-model"><i class="fa fa-check"></i><b>9.5</b> 多元线性回归(multiple regression model)</a></li>
<li class="chapter" data-level="9.6" data-path="regression.html"><a href="regression.html#定性自变量的回归"><i class="fa fa-check"></i><b>9.6</b> 定性自变量的回归</a></li>
<li class="chapter" data-level="9.7" data-path="regression.html"><a href="regression.html#非线性回归"><i class="fa fa-check"></i><b>9.7</b> 非线性回归</a></li>
<li class="chapter" data-level="9.8" data-path="regression.html"><a href="regression.html#建立回归模型"><i class="fa fa-check"></i><b>9.8</b> 建立回归模型</a></li>
<li class="chapter" data-level="9.9" data-path="regression.html"><a href="regression.html#回归中的常见错误"><i class="fa fa-check"></i><b>9.9</b> 回归中的常见错误</a></li>
<li class="chapter" data-level="9.10" data-path="regression.html"><a href="regression.html#logistic-回归"><i class="fa fa-check"></i><b>9.10</b> Logistic 回归</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cluster.html"><a href="cluster.html"><i class="fa fa-check"></i><b>10</b> Cluster Analysis</a><ul>
<li class="chapter" data-level="10.1" data-path="cluster.html"><a href="cluster.html#多元分布基本概念"><i class="fa fa-check"></i><b>10.1</b> 多元分布基本概念</a></li>
<li class="chapter" data-level="10.2" data-path="cluster.html"><a href="cluster.html#数据的变换处理"><i class="fa fa-check"></i><b>10.2</b> 数据的变换处理</a></li>
<li class="chapter" data-level="10.3" data-path="cluster.html"><a href="cluster.html#聚类分析"><i class="fa fa-check"></i><b>10.3</b> 聚类分析</a></li>
<li class="chapter" data-level="10.4" data-path="cluster.html"><a href="cluster.html#样品间亲疏程度的测度"><i class="fa fa-check"></i><b>10.4</b> 样品间亲疏程度的测度</a></li>
<li class="chapter" data-level="10.5" data-path="cluster.html"><a href="cluster.html#类与类之间的距离"><i class="fa fa-check"></i><b>10.5</b> 类与类之间的距离</a></li>
<li class="chapter" data-level="10.6" data-path="cluster.html"><a href="cluster.html#系统聚类hierarchical-clustering-method"><i class="fa fa-check"></i><b>10.6</b> 系统聚类(hierarchical clustering method)</a></li>
<li class="chapter" data-level="10.7" data-path="cluster.html"><a href="cluster.html#快速聚类k-means-clustering-method"><i class="fa fa-check"></i><b>10.7</b> 快速聚类(k-means clustering method)</a></li>
<li class="chapter" data-level="10.8" data-path="cluster.html"><a href="cluster.html#有序聚类"><i class="fa fa-check"></i><b>10.8</b> 有序聚类</a></li>
<li class="chapter" data-level="10.9" data-path="cluster.html"><a href="cluster.html#聚类分析的主要步骤"><i class="fa fa-check"></i><b>10.9</b> 聚类分析的主要步骤</a></li>
<li class="chapter" data-level="10.10" data-path="cluster.html"><a href="cluster.html#r语言中聚类分析实现"><i class="fa fa-check"></i><b>10.10</b> R语言中聚类分析实现</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="discriminant.html"><a href="discriminant.html"><i class="fa fa-check"></i><b>11</b> Discriminant Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="discriminant.html"><a href="discriminant.html#判别分析应用"><i class="fa fa-check"></i><b>11.1</b> 判别分析应用</a></li>
<li class="chapter" data-level="11.2" data-path="discriminant.html"><a href="discriminant.html#判别分析方法"><i class="fa fa-check"></i><b>11.2</b> 判别分析方法</a><ul>
<li class="chapter" data-level="11.2.1" data-path="discriminant.html"><a href="discriminant.html#距离判别法"><i class="fa fa-check"></i><b>11.2.1</b> 距离判别法</a></li>
<li class="chapter" data-level="11.2.2" data-path="discriminant.html"><a href="discriminant.html#fisher判别法"><i class="fa fa-check"></i><b>11.2.2</b> Fisher判别法</a></li>
<li class="chapter" data-level="11.2.3" data-path="discriminant.html"><a href="discriminant.html#bayes判别法"><i class="fa fa-check"></i><b>11.2.3</b> Bayes判别法</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="discriminant.html"><a href="discriminant.html#建立判别函数的方法"><i class="fa fa-check"></i><b>11.3</b> 建立判别函数的方法</a></li>
<li class="chapter" data-level="11.4" data-path="discriminant.html"><a href="discriminant.html#判别分析的步骤及注意事项"><i class="fa fa-check"></i><b>11.4</b> 判别分析的步骤及注意事项</a></li>
<li class="chapter" data-level="11.5" data-path="discriminant.html"><a href="discriminant.html#r语言中判别分析实现"><i class="fa fa-check"></i><b>11.5</b> R语言中判别分析实现</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>12</b> Priciple Component Analysis</a><ul>
<li class="chapter" data-level="12.1" data-path="pca.html"><a href="pca.html#主成分分析基本思想"><i class="fa fa-check"></i><b>12.1</b> 主成分分析基本思想</a></li>
<li class="chapter" data-level="12.2" data-path="pca.html"><a href="pca.html#几何解释与数学模型"><i class="fa fa-check"></i><b>12.2</b> 几何解释与数学模型</a><ul>
<li class="chapter" data-level="12.2.1" data-path="pca.html"><a href="pca.html#几何解释"><i class="fa fa-check"></i><b>12.2.1</b> 几何解释</a></li>
<li class="chapter" data-level="12.2.2" data-path="pca.html"><a href="pca.html#数学模型"><i class="fa fa-check"></i><b>12.2.2</b> 数学模型</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="pca.html"><a href="pca.html#主成分的推导"><i class="fa fa-check"></i><b>12.3</b> 主成分的推导</a></li>
<li class="chapter" data-level="12.4" data-path="pca.html"><a href="pca.html#主成分的性质"><i class="fa fa-check"></i><b>12.4</b> 主成分的性质</a></li>
<li class="chapter" data-level="12.5" data-path="pca.html"><a href="pca.html#主成分分析的步骤"><i class="fa fa-check"></i><b>12.5</b> 主成分分析的步骤</a></li>
<li class="chapter" data-level="12.6" data-path="pca.html"><a href="pca.html#主成分的应用与回归"><i class="fa fa-check"></i><b>12.6</b> 主成分的应用与回归</a></li>
<li class="chapter" data-level="12.7" data-path="pca.html"><a href="pca.html#主成分分析的r语言实现"><i class="fa fa-check"></i><b>12.7</b> 主成分分析的R语言实现</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="fa.html"><a href="fa.html"><i class="fa fa-check"></i><b>13</b> Factor Analysis</a><ul>
<li class="chapter" data-level="13.1" data-path="fa.html"><a href="fa.html#因子分析概念"><i class="fa fa-check"></i><b>13.1</b> 因子分析概念</a></li>
<li class="chapter" data-level="13.2" data-path="fa.html"><a href="fa.html#因子分析模型"><i class="fa fa-check"></i><b>13.2</b> 因子分析模型</a></li>
<li class="chapter" data-level="13.3" data-path="fa.html"><a href="fa.html#因子载荷矩阵的估计方法"><i class="fa fa-check"></i><b>13.3</b> 因子载荷矩阵的估计方法</a></li>
<li class="chapter" data-level="13.4" data-path="fa.html"><a href="fa.html#因子旋转正交变换"><i class="fa fa-check"></i><b>13.4</b> 因子旋转（正交变换）</a></li>
<li class="chapter" data-level="13.5" data-path="fa.html"><a href="fa.html#因子得分"><i class="fa fa-check"></i><b>13.5</b> 因子得分</a></li>
<li class="chapter" data-level="13.6" data-path="fa.html"><a href="fa.html#因子分析步骤"><i class="fa fa-check"></i><b>13.6</b> 因子分析步骤</a></li>
<li class="chapter" data-level="13.7" data-path="fa.html"><a href="fa.html#因子分析的r语言实现"><i class="fa fa-check"></i><b>13.7</b> 因子分析的R语言实现</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="homework.html"><a href="homework.html"><i class="fa fa-check"></i><b>14</b> Case and Practice</a><ul>
<li class="chapter" data-level="14.1" data-path="homework.html"><a href="homework.html#描述性统计与抽样分布"><i class="fa fa-check"></i><b>14.1</b> 描述性统计与抽样分布</a></li>
<li class="chapter" data-level="14.2" data-path="homework.html"><a href="homework.html#参数估计与假设检验"><i class="fa fa-check"></i><b>14.2</b> 参数估计与假设检验</a></li>
<li class="chapter" data-level="14.3" data-path="homework.html"><a href="homework.html#方差分析与回归分析"><i class="fa fa-check"></i><b>14.3</b> 方差分析与回归分析</a></li>
<li class="chapter" data-level="14.4" data-path="homework.html"><a href="homework.html#作业文档"><i class="fa fa-check"></i><b>14.4</b> 作业文档</a><ul>
<li class="chapter" data-level="14.4.1" data-path="homework.html"><a href="homework.html#描述性统计与抽样分布-1"><i class="fa fa-check"></i><b>14.4.1</b> 1 描述性统计与抽样分布</a></li>
<li class="chapter" data-level="14.4.2" data-path="homework.html"><a href="homework.html#参数估计与假设检验-1"><i class="fa fa-check"></i><b>14.4.2</b> 2 参数估计与假设检验</a></li>
<li class="chapter" data-level="14.4.3" data-path="homework.html"><a href="homework.html#方差分析与回归分析-1"><i class="fa fa-check"></i><b>14.4.3</b> 3 方差分析与回归分析</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">应用统计学与R语言实现学习笔记</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ANOVA" class="section level1">
<h1><span class="header-section-number">第 8 章</span> ANOVA</h1>
<p>本篇是第八章，内容是方差分析。方差分析是很多实验的基础以及很重要的分析手段，这一章内容相比较而言比较多。</p>
<div id="方差分析的引论" class="section level2">
<h2><span class="header-section-number">8.1</span> 方差分析的引论</h2>
<p>方差分析其实对我们来说并不陌生，因为大学搞生态的那群同学，实验中无数次出现了单方差因素分析的方法。那么方差分析究竟是什么呢？从引论来说，我们举个跟地学领域相关的例子。不同地貌对土壤有机质是否有影响？简单地说方差分析实质适合分析的是一系列数值型数据存在某个属性（也可以是某些），然后这个属性可以按照一定的规则分成几个类别（或者叫水平），我们想了解的就是，不同类别或者不同水平的这个数值是否存在显著性差异。简单的理解，它是处理分类型数据的。这里需要跟上一章提到的拟合优度检验、后面讲到的回归分析做些区别，拟合优度检验通常是分析两个分类变量的关系，回归分析则分析的是一个数值型变量（或多个数值型变量）对一个数值型变量的影响（或者说二者的关系）。而方差分析则是分析一个分类变量（或多个分类变量）对于一个数值变量的影响（或者说二者的关系）。</p>
<p>这里给出一些定义和术语（不喜好数学的同学可以跳过，但请记住我上面的内容）：</p>
<p><strong>方差分析(Analysis of Variance，ANOVA)</strong></p>
<p>研究分类型自变量对数值型因变量的影响。</p>
<blockquote>
<ul>
<li>一个或多个分类型自变量：两个或多个 (k 个) 处理或分类</li>
<li>一个数值型因变量</li>
</ul>
</blockquote>
<p>通过检验多个总体均值是否相等来判断是否有显著影响</p>
<blockquote>
<ul>
<li>通过分析数据的误差判断各总体均值是否相等</li>
</ul>
</blockquote>
<p>有单因子方差分析和双因子方差分析</p>
<blockquote>
<ul>
<li>单因子方差分析：涉及一个分类型自变量</li>
<li>双因子方差分析：涉及两个分类型自变量</li>
</ul>
</blockquote>
<p>方差分析 vs 假设检验</p>
<p>（1）假设检验：一次只能研究两个样本</p>
<blockquote>
<ul>
<li>需要比较的次数随因子的数量增多而增多；</li>
<li>第一类错误发生的可能性增大。</li>
</ul>
</blockquote>
<p>（2）方差分析：同时分析多个样本</p>
<blockquote>
<ul>
<li>提高检验效率；</li>
<li>将所有信息结合在一起， 增加了分析的可靠性。</li>
</ul>
</blockquote>
<div id="方差分析的部分概念" class="section level3">
<h3><span class="header-section-number">8.1.1</span> 方差分析的部分概念</h3>
<blockquote>
<ul>
<li>因子或因素 (factor)——所要检验的对象，要分析行业对投诉次数是否有影响， 行业是要检验的因子或因素。</li>
<li>水平或处理(treatment):因子的不同表现,零售业、 旅游业、 航空公司、 家电制造业就是因子的处理。</li>
<li>观察值：在每个因子处理下得到的样本数据，每个行业被投诉的次数就是观察值。</li>
<li>试验：涉及一个因子多水平， 可称为单因子多处理的试验。</li>
<li>总体：因子的每一个处理看作是一个总体。</li>
<li>样本数据：观察值可以看作是从着多个总体中抽取的样本数据</li>
</ul>
</blockquote>
<p>也就是说分类变量是因子或因素，而分的类别就可以称为水平或处理，观察值则是数值型变量。试验就是就是分类的过程，总体其实就是水平，样本数据就是观测值。</p>
<p>接下来讲讲方差分析的基本思想和原理。</p>
</div>
<div id="方差分析的基本思想和原理" class="section level3">
<h3><span class="header-section-number">8.1.2</span> 方差分析的基本思想和原理</h3>
<p>方差分析的基本思想和原理基于两类误差。也就是随机误差和系统误差。</p>
<blockquote>
<ul>
<li><strong>随机误差</strong>——因子的同一处理(总体)下， 样本各观察值之间的差异，这种差异可以看成是随机因素的影响， 称为随机误差。</li>
<li><strong>系统误差</strong>——因子的不同处理(不同总体)下，各观察值之间的差异，这种差异可能是由于抽样的随机性所造成的，也可能是由于行业本身所造成的，后者所形成的误差是由系统性因素造成的，称为系统误差。</li>
</ul>
</blockquote>
<p>所以方差分析的实质是——比较两类误差，以检验均值是否相等；比较的基础是方差比；如果系统（处理）误差明显地不同于随机误差，则均值就是不相等的；反之，均值就是相等的。这里数据的误差用平方和(sum of squares)表示。</p>
<blockquote>
<ul>
<li><strong>组内平方和(within groups)</strong>——因子的同一处理(同一个总体)下样本数据的平方和。组内平方和只包含随机误差。</li>
<li><strong>组间平方和(between groups)</strong>——因子的不同处理(不同总体)下各样本之间的平方和。组间平方和既包括随机误差， 也包括系统误差。</li>
</ul>
</blockquote>
<p>所以若原假设成立， 组间平方和与组内平方和经过平均后的数值就应该很接近， 它们的比值就会接近1。</p>
<blockquote>
<ul>
<li>若原假设不成立， 组间平方和平均后的数值就会大于组内平方和平均后的数值， 它们之间的比值就会大于1。</li>
<li>当这个比值大到某种程度时， 就可以说不同处理之间存在着显著差异， 也就是自变量对因变量有影响。</li>
</ul>
</blockquote>
</div>
<div id="方差分析的基本假定" class="section level3">
<h3><span class="header-section-number">8.1.3</span> 方差分析的基本假定</h3>
<p>（1）每个总体都应服从正态分布：对于因子的每一个处理， 其观察值是来自服从正态分布总体的简单随机样本。</p>
<p>（2）各个总体的方差必须相同：各组观察数据是从具有相同方差的总体中抽取的。</p>
<p>（3）观察值是独立的。</p>
<p>（4）在上述假定条件下， 判断行业对投诉次数是否有显著影响， 实际上也就是检验具有同方差的四个正态总体的均值是否相等。</p>
<p>（5）如果四个总体的均值相等， 可以期望四个样本的均值也会很接近：四个样本的均值越接近，推断四个总体均值相等的证据也就越充分；样本均值越不同， 推断总体均值不同的证据就越充分。</p>
<p>这里要注意的是，往往很多人做统计的时候往往不考虑前提和假设，这是一个错误。经典统计学中很多模型都有严密的数学推导和前提假设，就笔者从事的地学领域里其实有很多现象不是太遵循经典统计学的前提，由此也衍生出了空间统计学理论，所以在做统计研究时需要考量自己数据的特征，了解统计学与模型的基本前提与假设。</p>
<p>原假设：<span class="math inline">\(H_0:\mu_1=\mu_2=\mu_3=\cdots=\mu_n\)</span></p>
<blockquote>
<ul>
<li>n个水平被投诉次数的均值都相等；</li>
<li>意味着每个样本都来自均值为<span class="math inline">\(\mu\)</span>、方差为<span class="math inline">\(\sigma^2\)</span>的同一正态总体。</li>
</ul>
</blockquote>
<p>若备择假设成立，即<span class="math inline">\(H_1:\mu_i(i=1,2,3,\cdots,n)\)</span>不全相等</p>
<blockquote>
<ul>
<li>至少有一个总体的均值是不同的；</li>
<li>样本分别来自均值不同的多个个正态总体。</li>
</ul>
</blockquote>
</div>
</div>
<div id="单因子方差分析one-way-anova" class="section level2">
<h2><span class="header-section-number">8.2</span> 单因子方差分析（One-way ANOVA)</h2>
<p>从这章开始后面的部分基本是典型数据分析，故我会渗透更多的数据分析的一些经验和理念。在这里因为要正式进入方差分析的具体内容里，所以我想谈的一点是我曾经说过的一句话——编程先学数据结构。数据结构的重要性可以参加下面的知乎。</p>
<blockquote>
<ul>
<li><a href="https://www.zhihu.com/question/29587605" class="uri">https://www.zhihu.com/question/29587605</a></li>
</ul>
</blockquote>
<p>当然对于R或是其他数据处理语言来说，我觉得最关键的是你在使用分析数据（调用各种包）时需要了解你所调用的包或者函数处理的是什么样的数据（你要把数据处理成你的函数可以读的形式）。当然这是题外话，还是回到标题的单因子方差分析。如果一个试验中，只有一个因子在变，而其它因素保持不变，称此试验为单因子试验（只涉及一个分类型自变量）。那么它的数据结构如下所示：</p>
<p><img src="fig/fig21.jpg" width="100%" height="35%" /></p>
<p>当然事实上在分析的时候，个人觉得R和其他数据所能读取的数据结构或者说组织方式还是2列的变量（数值型变量与分类变量）。分析步骤则是统计学的经典三部曲：</p>
<blockquote>
<ul>
<li>提出假设；</li>
<li>构造检验统计量；</li>
<li>统计决策。</li>
</ul>
</blockquote>
<p>假设的提法在前面已经提过了。</p>
<p><span class="math inline">\(H_0:\mu_1=\mu_2=\mu_3=\cdots=\mu_n\)</span>（自变量对因变量没有显著影响）。</p>
<p><span class="math inline">\(H_1:\mu_1,\mu_2,\mu_3,\cdots,\mu_n\)</span>不全相等（自变量对因变量有显著影响）。</p>
<p>构造统计量需要计算:（1）处理的均值；（2）全部观察值的总均值；（3）平方和；（4）均方(MS)。（接下来是公式大全，公式恐惧症者请跳过）</p>
<p><strong>（1）处理的均值</strong></p>
<p>假定从第i个总体中抽取一个容量为<span class="math inline">\(n_i\)</span>的简单随机样本， 第i个总体的样本均值为该样本的全部观察值总和除以观察值的个数。</p>
<p><span class="math display">\[\bar x_i=\frac{\sum_{j=1}^nx_{ij}}{n_i} (i=1,2,\cdots,k)\]</span></p>
<p>式中： <span class="math inline">\(n_i\)</span>为第 i 个总体的样本观察值个数，<span class="math inline">\(x_{ij}\)</span>为第i个总体的第j个观察值。</p>
<p><strong>（2）全部观察值的总均值</strong></p>
<p>全部观察值的总和除以观察值的总个数。</p>
<p><span class="math display">\[\bar x&#39;=\frac{\sum_{i=1}^k\sum_{j=1}^nx_{ij}}{n}=\frac{\sum_{i=1}^kn_i\bar x_i}{n}\]</span></p>
<p><strong>（3）平方和</strong></p>
<p>方差分析需要计算三个平方和。
&gt; * 总平方和 (Sum of Squares for Total),SST。全部观察值与总平均值的离差平方和，反映全部观察值的离散状况。<span class="math inline">\(SST=\sum_{i=1}^k\sum_{j=1}^n(x_{ij}-\bar x&#39;)^2\)</span>
&gt; * 处理平方和 (Sum of Squares due to Treatment), SSTR，又叫组间平方和。各组平均值与总平均值的离差平方和，反映各总体的样本均值之间的差异程度，又称处理平方和或组间平方和，该平方和既包括随机误差， 也包括系统误差。<span class="math inline">\(SSTR= \sum_{i=1}^k\sum_{j=1}^n(\bar x_i-\bar x&#39;)^2=\Sigma_{i=1}^kn_i(\bar x_i-\bar x&#39;)^2\)</span>。
&gt; * 误差平方和 (Sum of Squares due to Error),SSE，又叫组内平方和。每个处理或组的各样本数据与其组平均值的离差平方和，反映每个样本各观察值的离散状况，又称组内平
方和或残差平方和，该平方和反映的是随机误差的大小。<span class="math inline">\(SSE=\sum_{i=1}^k\sum_{j=1}^n(x_ij-\bar x_i)^2\)</span>。</p>
<p>实际上，SST=SSTR+SSE。SST反映全部数据总的误差程度； SSE反映随机误差的大小；SSTR反映随机误差和系统误差的大小。如果原假设成立，则表明没有系统误差，处理平方和SSTR除以自由度后的均方与误差平方和SSE和除以自由度后的均方差异就不会太大；如果处理均方显著地大于误差均方，说明各处理(总体)之间的差异不仅有随机误差， 还有系统误差。判断因子的处理是否对其观察值有影响，实际上就是比较处理均方与误差均方之间差异的大小。</p>
<p><strong>（4）均方——构建检验统计量</strong></p>
<p>各平方和的大小与观察值的多少有关， 为消除观察值多少对平方和大小的影响， 需要将其平均， 这就是均方，也称为方差。计算方法是用平方和除以相应的自由度，三个平方和对应的自由度分别是： SST 的自由度为n-1，其中n为全部观察值的个数，SSTR的自由度为k-1， 其中k为因子处理(总体)的个数，SSE 的自由度为n-k。</p>
<p>处理均方：SSTR的均方， 记为MSTR， 计算公式为:</p>
<p><span class="math display">\[MSTR=\frac{SSTR}{k-1}\]</span></p>
<p>误差均方：SSE的均方，记为MSE， 计算公式为:</p>
<p><span class="math display">\[MSE=\frac{SSE}{n-k}\]</span></p>
<p>计算检验统计量F：</p>
<p>将MSTR和MSE进行对比， 即得到所需要的检验统计量F，当<span class="math inline">\(H_0\)</span>为真时， 二者的比值服从分子自由度为k-1、分母自由度为n-k的F分布， 即</p>
<p><span class="math display">\[F=\frac{MSTR}{MSE}\sim(k-1,n-k)\]</span></p>
<p>最后是统计决策将统计量的值F与给定的显著性水平<span class="math inline">\(\alpha\)</span>的临界值<span class="math inline">\(F_\alpha\)</span>进行比较，作出对原假设<span class="math inline">\(H_0\)</span>的决策。</p>
<blockquote>
<ul>
<li>根据给定的显著性水平<span class="math inline">\(\alpha\)</span>， 在F分布表中查找与第一自由度<span class="math inline">\(df_1=k-1\)</span>、 第二自由度<span class="math display">\[df_2=n-k\]</span> 相应的临界值<span class="math inline">\(F_\alpha\)</span>。</li>
<li>若F&gt;<span class="math inline">\(F_\alpha\)</span>，则拒绝原假设<span class="math inline">\(H_0\)</span>，表明均值之间的差异是显著的，所检验的因子对观察值有显著影响。</li>
<li>若F&lt;<span class="math inline">\(F_\alpha\)</span>，则不能拒绝原假设<span class="math inline">\(H_0\)</span>， 无证据支持表明所检验的因子对观察值有显著影响。</li>
</ul>
</blockquote>
<p>对前面的三部曲做一个进一步的总结：</p>
<p>（1）提出假设；</p>
<p>（2）构造检验统计量（均值：全部观察值的总均值、处理的均值；平方和：总平方和SST，处理平方和SSTR，误差平方和SSE；均方：处理均方MSTR，误差均方MSE；均方比：MSTR/MSE~F分布）；</p>
<p>（3） 统计决策。</p>
<p>在R语言中，方差分析函数较为简单，具体应用后面再说。value为观察值，factor为因素。</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="ANOVA.html#cb7-1"></a>a.aov&lt;-<span class="kw">aov</span>(value<span class="op">~</span>factor,<span class="dt">data=</span>a)</span>
<span id="cb7-2"><a href="ANOVA.html#cb7-2"></a><span class="kw">summary</span>(a.aov)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th>误差来源（方差来源）</th>
<th align="center">平方和(SS)</th>
<th align="center">自由度(df)</th>
<th align="center">均方(MS)</th>
<th align="right">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>组间（处理）</td>
<td align="center">SSTR</td>
<td align="center">k-1</td>
<td align="center">MSTR=SSTR/(k-1)</td>
<td align="right">MSTR/MSE</td>
</tr>
<tr class="even">
<td>组内（误差）</td>
<td align="center">SSE</td>
<td align="center">n-k</td>
<td align="center">MSE=SSE/(n-k)</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td>总计（合计）</td>
<td align="center">SST</td>
<td align="center">n-1</td>
<td align="center"></td>
<td align="right"></td>
</tr>
</tbody>
</table>
<p>当然仅仅证明有显著性差异，可能还不能满足我们的需求，所以需要测度方差分析的关系强度。</p>
<p><strong>关系强度的测量</strong></p>
<p>拒绝原假设表明因子(自变量)与观测值之间有关系，而处理平方和(SSTR)度量了自变量(行业)对因变量(投诉次数)的影响效应。</p>
<blockquote>
<ul>
<li>当处理平方和比误差平方和(SSE)大， 而且大到一定程度时， 就意味着两个变量之间的关系显著， 大得越多， 表明它们之间的关系就越强。 反之， 就意味着两个变量之间的关系不显著， 小得越多， 表明它们之间的关系就越弱。</li>
</ul>
</blockquote>
<p>变量间关系的强度用处理平方和(SSTR)及误差平方和(SSE)占总平方和(SST)的比例大小来反映。处理平方和占总平方和的比例记为<span class="math inline">\(R^2\)</span> ,即<span class="math inline">\(R^2=\frac{SSTR}{SST}\)</span>（处理平方和）/（总平方和）。其平方根R就可以用来测量两个变量之间的关系强度。</p>
</div>
<div id="方差分析中的多重比较" class="section level2">
<h2><span class="header-section-number">8.3</span> 方差分析中的多重比较</h2>
<p>多重比较（multiple comparison procedures）——通过对总体均值之间的配对比较来进一步检验到底哪些均值之间存在差异。</p>
<blockquote>
<ul>
<li>可采用Fisher提出的最小显著差异方法， 简写为LSD-least significant difference。LSD方法是对检验两个总体均值是否相等的t检验方法的总体方差估计加以修正（ 用MSE来代替） 而得到的。</li>
</ul>
</blockquote>
<p>方差分析中的多重比较分析步骤</p>
<p>（1）提出假设：<span class="math inline">\(H_0: \mu_i=\mu_j )\)</span>(第i个总体的均值等于第j个总体的均值，<span class="math inline">\(H_1:\mu_i\neq\mu_j\)</span>(第i个总体的均值不等于第j个总体的均值)；</p>
<p>（2）计算检验的统计量: <span class="math inline">\(\bar x_i-\bar x_j\)</span>；</p>
<p>（3）计算LSD,t分布的自由度为n-k（MSE的自由度为n-k）。<span class="math inline">\(LSD=t_{\alpha/2}\sqrt{MSE(\frac{1}{n_i}+\frac{1}{n_j})}\)</span></p>
<p>（4）决策：若<span class="math inline">\(\vert {\bar x_i-\bar x_j} \vert &gt; LSD\)</span>，拒绝<span class="math inline">\(H_0\)</span>；若<span class="math inline">\(\vert {\bar x_i-\bar x_j} \vert &lt; LSD\)</span>，不拒绝<span class="math inline">\(H_0\)</span>。</p>
</div>
<div id="双因子方差分析two-way-anova" class="section level2">
<h2><span class="header-section-number">8.4</span> 双因子方差分析（Two-way ANOVA）</h2>
<p>前面介绍完了单因子方差分析，但是当我们的因子大于一个的时候，我们又该怎么分析呢？同样抛个样例问题出来。
假设现在我们想了解北京城市人口空间分布是否受不同环路（一环、二环、三环乃至四、五、六环）或新老城区的显著影响。所以该问题是一个典型的双因子问题，可以拆分为如下的情况：</p>
<table>
<thead>
<tr class="header">
<th>因子</th>
<th align="center">新城区</th>
<th align="right">老城区</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>一环</td>
<td align="center">人口</td>
<td align="right">人口</td>
</tr>
<tr class="even">
<td>二环</td>
<td align="center">人口</td>
<td align="right">人口</td>
</tr>
<tr class="odd">
<td>三环</td>
<td align="center">人口</td>
<td align="right">人口</td>
</tr>
</tbody>
</table>
<p>对于该问题我们可以考虑用单因子方差分析来解决——即通过考虑两个因子间所有的组合来分析是否有显著影响。（二环+新城区，二环+老城区，三环+新城区，……，六环+老城区）通过这样组合来得到最后的单因子水平。但是这样处理的问题是，我们无法了解到底是新老城区的因素影响了人口的空间分布，或者是不同的环路影响了人口的空间分布，亦或是二者共同影响。所以我们需要新的方法来分析。这就是题目所述的双因子方差分析。</p>
<div id="双因子方差分析的基本假定" class="section level3">
<h3><span class="header-section-number">8.4.1</span> 双因子方差分析的基本假定</h3>
<p>（1） 每个总体都服从正态分布（对于因素的每一个水平， 其观察值是来自正态分布总体的简单随机样本）。</p>
<p>（2） 各个总体的方差必须相同（对于各组观察数据， 是从具有相同方差的总体中抽取的）。</p>
<p>（3） 观察值是独立的。</p>
<p>双因子方差分析实质是分析两个因素(行因素Row和列因素Column)对试验结果的影响。如果两个因素对试验结果的影响是相互独立的，分别判断行因素和列因素对试验数据的影响， 这时的双因素方差分析称为<strong>无交互作用的双因素方差分析</strong>或<strong>无重复双因素方差分析</strong>(Two-factor without replication)。如果除了行因素和列因素对试验数据的单独影响外，两个因素的搭配还会对结果产生一种新的影响， 这时的双因素方差分析称为<strong>有交互作用的双因素方差分析</strong>或<strong>可重复双因素方差分析</strong> (Two-factor with replication )。</p>
</div>
<div id="无交互作用双因子方差分析" class="section level3">
<h3><span class="header-section-number">8.4.2</span> 无交互作用双因子方差分析</h3>
<p>如果在一项试验中，有两个因子在变，而其余因子保持不变，则称之为双因子试验。</p>
<blockquote>
<ul>
<li>设因子A有a个水平<span class="math inline">\(A_1,A_2,\cdots,A_a\)</span>，因子B有b个水平<span class="math inline">\(B_1,B_2,\cdots,B_b\)</span>，每组因子组合进行1次试验，其结果为<span class="math inline">\(x_{ij},x_{ij}\sim N(\mu_{ij},\sigma^2)\)</span>,现在要研究它们对因变量X的影响。</li>
</ul>
</blockquote>
<p><strong>（1）无交互作用双因子方差分析：模型</strong></p>
<p><span class="math display">\[X_{ij}=\mu+\alpha_i+\beta_j+\varepsilon_{ij}\]</span></p>
<p>这里<span class="math inline">\(\varepsilon_{ij}\sim iid,N(0,\sigma^2)\)</span></p>
<p><strong>（2）无交互作用双因子方差分析：假设</strong></p>
<p>因子A</p>
<p>原假设：<span class="math inline">\(H_0:\alpha_1= \alpha_2=\cdots= \alpha_a=0\)</span></p>
<p>备择假设：<span class="math inline">\(H_1\)</span>:至少一个<span class="math inline">\(\alpha_i\)</span>不等于0</p>
<p>因子B</p>
<p>原假设：<span class="math inline">\(H_0: \beta_1 = \beta_2 =\cdots= \beta_b=0\)</span></p>
<p>备择假设：<span class="math inline">\(H_1\)</span>:至少一个<span class="math inline">\(\beta_i\)</span>不等于0</p>
<p><strong>（3）计算步骤（公式大全）</strong>
&gt; * 均方：</p>
<p><span class="math inline">\(\bar x_{i.}\)</span>是A因素的第i个水平下各观察值的平均值</p>
<p><span class="math display">\[\bar x_{i.}=\frac{\sum_{j=1}^bx_{ij}}{b}(i=1,2,\cdots,a)\]</span></p>
<p><span class="math inline">\(\bar x_{.j}\)</span>是B因素的第j个水平下各观察值的平均值</p>
<p><span class="math display">\[\bar x_{.j}=\frac{\sum_{i=1}^ax_{ij}}{a}(i=1,2,\cdots,b)\]</span></p>
<p><span class="math inline">\(\bar x&#39;\)</span>是B因素的第j个水平下各观察值的平均值</p>
<p><span class="math display">\[\bar x&#39;=\frac{\sum_{i=1}^a\sum_{j=1}^bx_{ij}}{ab}\]</span></p>
<blockquote>
<ul>
<li>平方和：</li>
</ul>
</blockquote>
<p><span class="math display">\[SST=\sum_{i=1}^a\sum_{j=1}^b(x_{ij}-\bar x&#39;)^2\]</span></p>
<p><span class="math display">\[SSA=b\sum_{i=1}^a(x_{i.}-\bar x&#39;)^2\]</span></p>
<p><span class="math display">\[SSB=a\sum_{j=1}^b(x_{.j}-\bar x&#39;)^2\]</span></p>
<p><span class="math display">\[SSE=\sum_{i=1}^a\sum_{j=1}^b(x_{ij}-x_{i.}-x_{.j}+\bar x&#39;)^2\]</span></p>
<p><span class="math display">\[SST=SSA+SSB+SSE\]</span></p>
<blockquote>
<ul>
<li>计算均方（MS）构造检验统计量：误差平方和除以相应的自由度</li>
</ul>
</blockquote>
<p>四个平方和的自由度分别是：总离差平方和SST的自由度为 ab-1；A因素的离差平方和SSA的自由度为 a-1；
B因素的离差平方和SSB的自由度为 b-1；随机误差平方和SSE的自由度为 (a-1)×(b-1)。</p>
<p>A因素的均方，记为MSA，计算公式为：</p>
<p><span class="math display">\[MSA=\frac{SSA}{a-1}\]</span></p>
<p>B因素的均方，记为MSB，计算公式为：</p>
<p><span class="math display">\[MSB=\frac{SSB}{b-1}\]</span></p>
<p>随机误差项的均方，记为MSE，计算公式为：</p>
<p><span class="math display">\[MSE=\frac{SSE}{(a-1)(b-1)}\]</span></p>
<blockquote>
<ul>
<li>计算检验统计量(F)</li>
</ul>
</blockquote>
<p>检验行因素的统计量</p>
<p><span class="math display">\[F_A=\frac{MSA}{MSE}\sim F(a-1,(a-1)(b-1))\]</span></p>
<p>检验列因素的统计量</p>
<p><span class="math display">\[F_B=\frac{MSB}{MSE}\sim F(b-1,(a-1)(b-1))\]</span></p>
<blockquote>
<ul>
<li>统计决策</li>
</ul>
</blockquote>
<p>将统计量的值F与给定的显著性水平<span class="math inline">\(\alpha\)</span>的临界值<span class="math inline">\(F_\alpha\)</span>进行比较，作出对原假设<span class="math inline">\(H_0\)</span>的决策：根据给定的显著性水平a在F分布表中查找相应的临界值<span class="math inline">\(F_\alpha\)</span>；若<span class="math inline">\(F_A&gt;F_\alpha\)</span>，则拒绝原假设，表明均值之间的差异是显著的， 即所检验的A因素对观察值有显著影响；若<span class="math inline">\(F_A&gt;F_\alpha\)</span>，则拒绝原假设，表明均值之间有显著差异，即所检验的B因素对观察值有显著影响。</p>
<table>
<thead>
<tr class="header">
<th>误差来源（方差来源）</th>
<th align="center">平方和</th>
<th align="center">自由度</th>
<th align="center">均方</th>
<th align="right">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>因子A</td>
<td align="center">SSA</td>
<td align="center">a-1</td>
<td align="center">MSA=SSA/(a-1)</td>
<td align="right">MSA/MSE</td>
</tr>
<tr class="even">
<td>因子B</td>
<td align="center">SSB</td>
<td align="center">b-1</td>
<td align="center">MSB=SSB/(b-1)</td>
<td align="right">MSB/MSE</td>
</tr>
<tr class="odd">
<td>误差</td>
<td align="center">SSE</td>
<td align="center">(a-1)(b-1)</td>
<td align="center">MSE=SSE/(a-1)(b-1))</td>
<td align="right"></td>
</tr>
<tr class="even">
<td>总计</td>
<td align="center">SST</td>
<td align="center">ab-1</td>
<td align="center"></td>
<td align="right"></td>
</tr>
</tbody>
</table>
</div>
<div id="有交互作用双因子方差分析" class="section level3">
<h3><span class="header-section-number">8.4.3</span> 有交互作用双因子方差分析</h3>
<p>除了上面的无交互作用双因子方差分析之外，可能存在的一种情况就是二者同时作用，这就是有交互作用的双因子方差分析。
即（<span class="math inline">\(A_i,B_j\)</span>）下作了r个试验，所得结果记作<span class="math inline">\(x_{ijk},x_{ijk}\)</span>服从<span class="math inline">\(N(\mu_{ij},\sigma^2),i=1,\cdots,a,j=1,\cdots,b,k=1,\cdots,r\)</span>。且相互独立。</p>
<p><strong>（1）有交互作用双因子方差分析：模型</strong></p>
<p><span class="math display">\[X_{ijk}=\mu+\alpha_i+\beta_j+(\alpha\beta)_{ij}+\varepsilon_{ijk}\]</span></p>
<p>这里<span class="math inline">\(\varepsilon_{ijk}\sim iid,N(0,\sigma^2)\)</span></p>
<p><strong>（2）交互作用双因子方差分析：假设</strong></p>
<p>因子A</p>
<p>原假设：<span class="math inline">\(H_0:\alpha_1= \alpha_2=\cdots= \alpha_a=0\)</span></p>
<p>备择假设：<span class="math inline">\(H1\)</span>:至少一个<span class="math inline">\(\alpha_i\)</span>不等于0</p>
<p>因子B</p>
<p>原假设：<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\beta_1 = \beta_2 = \cdots = \beta_b=0\)</span></p>
<p>备择假设：<span class="math inline">\(H1\)</span>:至少一个<span class="math inline">\(\beta_i\)</span>不等于0</p>
<p>交互作用</p>
<p>原假设：<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\alpha\beta_{11} = \alpha\beta_{12} = \cdots = \alpha\beta_{ab}=0\)</span></p>
<p>备择假设：<span class="math inline">\(H_1\)</span>:至少一个<span class="math inline">\(\alpha\beta_{ij}\)</span>不等于0</p>
<p><strong>计算步骤（公式大全）</strong></p>
<p>平方和</p>
<p><span class="math display">\[SST=\sum_{i=1}^a\sum_{j=1}^b\sum_{k=1}^r(x_{ij}-\bar x&#39;)^2\]</span></p>
<p><span class="math display">\[SSA=br\sum_{i=1}^a(x_{i.}-\bar x&#39;)^2\]</span></p>
<p><span class="math display">\[SSB=ar\sum_{j=1}^b(x_{.j}-\bar x&#39;)^2\]</span></p>
<p><span class="math display">\[SSAB=r\sum_{i=1}^a\sum_{j=1}^b(\bar x_{ij}-\bar x_{i.}-\bar x_{.j}+\bar x&#39;)^2\]</span></p>
<p><span class="math display">\[SSE=\sum_{i=1}^a\sum_{j=1}^b\sum_{k=1}^r(x_{ijk}-\bar x_{ij})^2\]</span></p>
<p><span class="math display">\[SST=SSA+SSB+SSAB+SSE\]</span></p>
<p>计算检验统计量(F)</p>
<p><span class="math display">\[F_A=\frac{MSA}{MSE}\sim F(a-1,ab(r-1))\]</span></p>
<p><span class="math display">\[F_B=\frac{MSB}{MSE}\sim F(b-1,ab(r-1))\]</span></p>
<p><span class="math display">\[F_{AB}=\frac{MSAB}{MSE}\sim F((a-1)(b-1),ab(r-1))\]</span></p>
<p>拒绝域</p>
<p><span class="math display">\[F_A&gt; F_\alpha(a-1,ab(r-1))\]</span></p>
<p><span class="math display">\[F_B&gt; F_\alpha(b-1,ab(r-1))\]</span></p>
<p><span class="math display">\[F_{AB}&gt; F_\alpha((a-1)(b-1),ab(r-1))\]</span></p>
<table>
<thead>
<tr class="header">
<th>误差来源（方差来源）</th>
<th align="center">平方和</th>
<th align="center">自由度</th>
<th align="center">均方</th>
<th align="right">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>因子A</td>
<td align="center">SSA</td>
<td align="center">a-1</td>
<td align="center">MSA=SSA/(a-1)</td>
<td align="right">MSA/MSE</td>
</tr>
<tr class="even">
<td>因子B</td>
<td align="center">SSB</td>
<td align="center">b-1</td>
<td align="center">MSB=SSB/(b-1)</td>
<td align="right">MSB/MSE</td>
</tr>
<tr class="odd">
<td>交互作用</td>
<td align="center">SSAB</td>
<td align="center">(a-1)(b-1)</td>
<td align="center">MSB=SSAB/(a-1)(b-1)</td>
<td align="right">MSAB/MSE</td>
</tr>
<tr class="even">
<td>误差</td>
<td align="center">SSE</td>
<td align="center">ab(r-1)</td>
<td align="center">MSE=SSE/ab(r-1))</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td>总计</td>
<td align="center">SST</td>
<td align="center">abr-1</td>
<td align="center"></td>
<td align="right"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="实验设计初步" class="section level2">
<h2><span class="header-section-number">8.5</span> 实验设计初步</h2>
<p>谈完了方差分析的各种理论，回顾开头我们提到的“搞实验的同学经常使用单因素方差分析”，所以在实验设计里，方差分析的应用是非常普遍的。所以这里也谈谈实验设计的一些内容（笔者非实验设计人员，所以仅谈谈一些理念）。一个实验必须施加一些处理，来观察这些处理会不会对实验结果或者测量值有影响。不同的处理是用来比较不同的总体。而好的实验，这些处理必须是随机的。所谓的随机就是指，每个样本有同等的机会（等概率事件）接收这些处理。所以对于这个随机化的比喻就是，你必须闭着眼睛选，才能保证你选的水平是随机的。实验相比于观察的优点也在于此，随机化使的两个比较总体尽可能相似，一切东西都是一样的除了选择处理的水平，如果实验结果存在差异的话，我们就能得出结论，这个处理是否会造成实验结果的不同。实验是我们设计的，可以控制实验的变量（很熟悉的控制变量法）——我们能保证我们比较的两个总体除了处理之外大致是一样的，而观察则无法保证我们所观察的两个总体仅仅存在某个处理上的差异，其他都是一致的。</p>
<p>从这个角度来说，实验设计的注意要点如下：</p>
<p>（1） 因子数量（单因子方差分析，双因子方差分析……）；</p>
<p>（2） 因子处理的数量;</p>
<p>（3） 实验设计类型。</p>
<p>前两个点大家可能都很清楚了，主要谈谈第三个点。实验设计类型严格来说包括如下： （1）完全因素位级组合（Full factorial design）: 完全随机化设计，随机化区组设计；（2）部分因素位级组合（Fractional factorial design）。</p>
<p><strong>（1）完全因素位级组合（Full factorial design）</strong></p>
<p>顾名思义，就是讲所有因子的所有组合考虑一遍，造成的问题就是——实验规模巨大。以下几个要点：</p>
<blockquote>
<ul>
<li>如果有k个因子，对于k个因子的第i个水平来说，会有<span class="math inline">\(n_i\)</span>个水平的观测值：<span class="math inline">\(n=\prod_{i=1}^k n_i\)</span></li>
<li>必须实验每个可能的因子水平的组合。</li>
<li>必须捕获有关交互的全部信息。</li>
<li>大量的工作。</li>
</ul>
</blockquote>
<p>主要还包括两种类型。</p>
<blockquote>
<ul>
<li>完全随机化设计(completely randomized design)——“处理” 被随机地指派给试验单元的一种设计，“处理” 是指可控制的因子的各个水平 “试验单元(experiment unit)”是接受“处理”的对象或实体。</li>
<li>随机化区组设计(randomized block design)——先按一定规则将试验单元划分为若干同质组， 称为“ 区组(block)”，再将各种处理随机地指派给各个区组,分组后再将每个品种（ 处理） 随机地指派给每一
个区组的设计就是随机化区组设计。<strong>如果可能， 我们应选择随机化区组设计</strong>。</li>
</ul>
</blockquote>
<p><strong>（2）部分因素位级组合（Fractional factorial design）</strong></p>
<blockquote>
<ul>
<li>仅测量部分因子水平的组合的结果。</li>
<li>必须认真设计来捕获所有可能的交互作用。</li>
<li>相比而言，工作量降低了，不确定性增大了。</li>
<li>在知道一些因子不存在交互作用的前提下特别有效。</li>
</ul>
</blockquote>
<p>典型的是正交试验设计——利用“正交表”进行科学地安排与分析多因子试验的方法。其主要优点是能在很多试验方案中挑选出代表性强的少数几个试验方案，并且通过这少数试验方案的试验结果的分析，推断出最优方案，同时还可以作进一步的分析，得到比试验结果本身给出的还要多的有关各因子的信息。
&gt; * 正交表的性质（正交性）：每列中不同数字出现的次数是相等的。每个因子不同的水平出现的次数相同。表示：在试验安排中，所挑选出来的水平组合是均匀分布的（每个因子的各水平出现的次数相同）——<strong>整齐可比性</strong>。对于任意两列，将同一行的两个数字看成有序数对时，每种数对出现的次数是相等的。任意两个因子都全面试验。表示：任意两因子的各种水平的搭配在所选试验中出现的次数相等——<strong>均衡分散性</strong>。正交表的优点：各因子的各水平的搭配是均衡的。试验点均衡分散在全部试验条件之中，使得它的代表性很强，能够比较全面地反映、分析出全面试验的最优点来。
&gt; * 用正交表安排试验的步骤：明确试验目的，确定试验指标。确定要考察的（主要）因子和水平——各水平次序最好随机排列（因为正交试验不是全面试验）。选用合适的正交表，安排试验计划：根据因子的水平，选择相应水平的正交表；再根据欲考察因子的个数选定正交表中因子的个数。
根据计划进行试验，确定试验指标。对试验结果进行分析，得出合理的结论。
&gt; * 正交试验结果的分析方法</p>
<p><strong>直观分析法</strong>：简单、直观、容易操作，计算量少。</p>
<p><strong>方差分析</strong>：理论根据可靠，结果可信度高，计算量比较大。</p>
<p><strong>正交试验的直观分析法</strong></p>
<p>计算各因子各水平的综合平均值，选出各因子的最优水平。对给定因子的每个水平，其它因子对试验指标的影响是相同的，因此可用综合平均值来比较各指标对试验指标的影响（综合可比性）。
计算个因子综合平均值的极差，分清因子的主次（在平均值中最大数与最小数之差，称为极差。极差的大小序列，表示因子的重要性大小）。
选定最优组合——选定最优组合的原则：对于重要因子，一定要选最优水平，以期达到较好试验效果；对于不重要因子，由于它们的水平变动对试验结果影响不大，可根据节约、高效、简便易行等实际情况灵活选定其水平。</p>
<p><strong>正交试验的方差分析</strong></p>
<p>假定试验指标服从正态分布
基本思想与双因子方差分析方法一致：将总的离差平方和分解成各因子及各交互作用的离差平方和，构造F统计量，对各因子是否对试验指标具有显著影响，作F检验。</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="goodness.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-chinese/edit/master/08-anova.Rmd",
"text": "编辑"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
