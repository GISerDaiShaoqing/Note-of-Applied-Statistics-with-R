<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 14 章 Case and Practice | 应用统计学与R语言实现学习笔记</title>
  <meta name="description" content="第 14 章 Case and Practice | 应用统计学与R语言实现学习笔记" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="第 14 章 Case and Practice | 应用统计学与R语言实现学习笔记" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.jpg" />
  
  <meta name="github-repo" content="GISerDaiShaoqing/Note-of-Applied-Statistics-with-R-Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 14 章 Case and Practice | 应用统计学与R语言实现学习笔记" />
  
  
  <meta name="twitter:image" content="images/cover.jpg" />

<meta name="author" content="戴劭勍" />


<meta name="date" content="2021-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fa.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">中文书示例</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#致谢"><i class="fa fa-check"></i>致谢</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#从问题说起"><i class="fa fa-check"></i><b>1.1</b> 从问题说起</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#统计学及其研究过程"><i class="fa fa-check"></i><b>1.2</b> 统计学及其研究过程</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#统计方法及其应用领域"><i class="fa fa-check"></i><b>1.3</b> 统计方法及其应用领域</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#统计数据类型"><i class="fa fa-check"></i><b>1.4</b> 统计数据类型</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#统计学中的几个基本概念"><i class="fa fa-check"></i><b>1.5</b> 统计学中的几个基本概念</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datacollec.html"><a href="datacollec.html"><i class="fa fa-check"></i><b>2</b> Data Collection</a><ul>
<li class="chapter" data-level="2.1" data-path="datacollec.html"><a href="datacollec.html#数据来源"><i class="fa fa-check"></i><b>2.1</b> 数据来源</a></li>
<li class="chapter" data-level="2.2" data-path="datacollec.html"><a href="datacollec.html#调查设计"><i class="fa fa-check"></i><b>2.2</b> 调查设计</a></li>
<li class="chapter" data-level="2.3" data-path="datacollec.html"><a href="datacollec.html#数据质量"><i class="fa fa-check"></i><b>2.3</b> 数据质量</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptive.html"><a href="descriptive.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="descriptive.html"><a href="descriptive.html#数据的预处理"><i class="fa fa-check"></i><b>3.1</b> 数据的预处理</a></li>
<li class="chapter" data-level="3.2" data-path="descriptive.html"><a href="descriptive.html#数据的整理与展示"><i class="fa fa-check"></i><b>3.2</b> 数据的整理与展示</a></li>
<li class="chapter" data-level="3.3" data-path="descriptive.html"><a href="descriptive.html#数据的概括性度量"><i class="fa fa-check"></i><b>3.3</b> 数据的概括性度量</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>4</b> Sampling And Sample Distribution</a><ul>
<li class="chapter" data-level="4.1" data-path="sampling.html"><a href="sampling.html#抽样方法"><i class="fa fa-check"></i><b>4.1</b> 抽样方法</a></li>
<li class="chapter" data-level="4.2" data-path="sampling.html"><a href="sampling.html#正态分布"><i class="fa fa-check"></i><b>4.2</b> 正态分布</a></li>
<li class="chapter" data-level="4.3" data-path="sampling.html"><a href="sampling.html#三种不同性质的分布"><i class="fa fa-check"></i><b>4.3</b> 三种不同性质的分布</a></li>
<li class="chapter" data-level="4.4" data-path="sampling.html"><a href="sampling.html#一个总体样本统计量的抽样分布"><i class="fa fa-check"></i><b>4.4</b> 一个总体样本统计量的抽样分布</a></li>
<li class="chapter" data-level="4.5" data-path="sampling.html"><a href="sampling.html#两个总体样本统计量的抽样分布"><i class="fa fa-check"></i><b>4.5</b> 两个总体样本统计量的抽样分布</a></li>
<li class="chapter" data-level="4.6" data-path="sampling.html"><a href="sampling.html#附录"><i class="fa fa-check"></i><b>4.6</b> 附录</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>5</b> Estimation</a><ul>
<li class="chapter" data-level="5.1" data-path="estimation.html"><a href="estimation.html#参数估计的一般问题"><i class="fa fa-check"></i><b>5.1</b> 参数估计的一般问题</a></li>
<li class="chapter" data-level="5.2" data-path="estimation.html"><a href="estimation.html#区间估计-confidence-intervals"><i class="fa fa-check"></i><b>5.2</b> 区间估计 Confidence Intervals</a></li>
<li class="chapter" data-level="5.3" data-path="estimation.html"><a href="estimation.html#样本容量的确定"><i class="fa fa-check"></i><b>5.3</b> 样本容量的确定</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hypothesis.html"><a href="hypothesis.html"><i class="fa fa-check"></i><b>6</b> Hypothesis Test</a><ul>
<li class="chapter" data-level="6.1" data-path="hypothesis.html"><a href="hypothesis.html#基本思想"><i class="fa fa-check"></i><b>6.1</b> 基本思想</a></li>
<li class="chapter" data-level="6.2" data-path="hypothesis.html"><a href="hypothesis.html#原假设和备择假设"><i class="fa fa-check"></i><b>6.2</b> 原假设和备择假设</a></li>
<li class="chapter" data-level="6.3" data-path="hypothesis.html"><a href="hypothesis.html#第一类错误和第二类错误"><i class="fa fa-check"></i><b>6.3</b> 第一类错误和第二类错误</a></li>
<li class="chapter" data-level="6.4" data-path="hypothesis.html"><a href="hypothesis.html#统计量与拒绝域"><i class="fa fa-check"></i><b>6.4</b> 统计量与拒绝域</a></li>
<li class="chapter" data-level="6.5" data-path="hypothesis.html"><a href="hypothesis.html#利用p值进行决策"><i class="fa fa-check"></i><b>6.5</b> 利用p值进行决策</a></li>
<li class="chapter" data-level="6.6" data-path="hypothesis.html"><a href="hypothesis.html#一个总体参数的检验"><i class="fa fa-check"></i><b>6.6</b> 一个总体参数的检验</a></li>
<li class="chapter" data-level="6.7" data-path="hypothesis.html"><a href="hypothesis.html#两个总体参数的检验"><i class="fa fa-check"></i><b>6.7</b> 两个总体参数的检验</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="goodness.html"><a href="goodness.html"><i class="fa fa-check"></i><b>7</b> Goodness of Fit</a><ul>
<li class="chapter" data-level="7.1" data-path="goodness.html"><a href="goodness.html#多项分布"><i class="fa fa-check"></i><b>7.1</b> 多项分布</a></li>
<li class="chapter" data-level="7.2" data-path="goodness.html"><a href="goodness.html#独立性"><i class="fa fa-check"></i><b>7.2</b> 独立性</a></li>
<li class="chapter" data-level="7.3" data-path="goodness.html"><a href="goodness.html#概率分布"><i class="fa fa-check"></i><b>7.3</b> 概率分布</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ANOVA.html"><a href="ANOVA.html"><i class="fa fa-check"></i><b>8</b> ANOVA</a><ul>
<li class="chapter" data-level="8.1" data-path="ANOVA.html"><a href="ANOVA.html#方差分析的引论"><i class="fa fa-check"></i><b>8.1</b> 方差分析的引论</a><ul>
<li class="chapter" data-level="8.1.1" data-path="ANOVA.html"><a href="ANOVA.html#方差分析的部分概念"><i class="fa fa-check"></i><b>8.1.1</b> 方差分析的部分概念</a></li>
<li class="chapter" data-level="8.1.2" data-path="ANOVA.html"><a href="ANOVA.html#方差分析的基本思想和原理"><i class="fa fa-check"></i><b>8.1.2</b> 方差分析的基本思想和原理</a></li>
<li class="chapter" data-level="8.1.3" data-path="ANOVA.html"><a href="ANOVA.html#方差分析的基本假定"><i class="fa fa-check"></i><b>8.1.3</b> 方差分析的基本假定</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ANOVA.html"><a href="ANOVA.html#单因子方差分析one-way-anova"><i class="fa fa-check"></i><b>8.2</b> 单因子方差分析（One-way ANOVA)</a></li>
<li class="chapter" data-level="8.3" data-path="ANOVA.html"><a href="ANOVA.html#方差分析中的多重比较"><i class="fa fa-check"></i><b>8.3</b> 方差分析中的多重比较</a></li>
<li class="chapter" data-level="8.4" data-path="ANOVA.html"><a href="ANOVA.html#双因子方差分析two-way-anova"><i class="fa fa-check"></i><b>8.4</b> 双因子方差分析（Two-way ANOVA）</a><ul>
<li class="chapter" data-level="8.4.1" data-path="ANOVA.html"><a href="ANOVA.html#双因子方差分析的基本假定"><i class="fa fa-check"></i><b>8.4.1</b> 双因子方差分析的基本假定</a></li>
<li class="chapter" data-level="8.4.2" data-path="ANOVA.html"><a href="ANOVA.html#无交互作用双因子方差分析"><i class="fa fa-check"></i><b>8.4.2</b> 无交互作用双因子方差分析</a></li>
<li class="chapter" data-level="8.4.3" data-path="ANOVA.html"><a href="ANOVA.html#有交互作用双因子方差分析"><i class="fa fa-check"></i><b>8.4.3</b> 有交互作用双因子方差分析</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ANOVA.html"><a href="ANOVA.html#实验设计初步"><i class="fa fa-check"></i><b>8.5</b> 实验设计初步</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Linear Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#变量间的关系"><i class="fa fa-check"></i><b>9.1</b> 变量间的关系</a></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#回归分析和简单线性回归分析"><i class="fa fa-check"></i><b>9.2</b> 回归分析和简单线性回归分析</a><ul>
<li class="chapter" data-level="9.2.1" data-path="regression.html"><a href="regression.html#回归分析"><i class="fa fa-check"></i><b>9.2.1</b> 回归分析</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#简单线性回归分析"><i class="fa fa-check"></i><b>9.2.2</b> 简单线性回归分析</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#利用回归方程进行估计和预测"><i class="fa fa-check"></i><b>9.3</b> 利用回归方程进行估计和预测</a></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#残差分析"><i class="fa fa-check"></i><b>9.4</b> 残差分析</a></li>
<li class="chapter" data-level="9.5" data-path="regression.html"><a href="regression.html#多元线性回归multiple-regression-model"><i class="fa fa-check"></i><b>9.5</b> 多元线性回归(multiple regression model)</a></li>
<li class="chapter" data-level="9.6" data-path="regression.html"><a href="regression.html#定性自变量的回归"><i class="fa fa-check"></i><b>9.6</b> 定性自变量的回归</a></li>
<li class="chapter" data-level="9.7" data-path="regression.html"><a href="regression.html#非线性回归"><i class="fa fa-check"></i><b>9.7</b> 非线性回归</a></li>
<li class="chapter" data-level="9.8" data-path="regression.html"><a href="regression.html#建立回归模型"><i class="fa fa-check"></i><b>9.8</b> 建立回归模型</a></li>
<li class="chapter" data-level="9.9" data-path="regression.html"><a href="regression.html#回归中的常见错误"><i class="fa fa-check"></i><b>9.9</b> 回归中的常见错误</a></li>
<li class="chapter" data-level="9.10" data-path="regression.html"><a href="regression.html#logistic-回归"><i class="fa fa-check"></i><b>9.10</b> Logistic 回归</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cluster.html"><a href="cluster.html"><i class="fa fa-check"></i><b>10</b> Cluster Analysis</a><ul>
<li class="chapter" data-level="10.1" data-path="cluster.html"><a href="cluster.html#多元分布基本概念"><i class="fa fa-check"></i><b>10.1</b> 多元分布基本概念</a></li>
<li class="chapter" data-level="10.2" data-path="cluster.html"><a href="cluster.html#数据的变换处理"><i class="fa fa-check"></i><b>10.2</b> 数据的变换处理</a></li>
<li class="chapter" data-level="10.3" data-path="cluster.html"><a href="cluster.html#聚类分析"><i class="fa fa-check"></i><b>10.3</b> 聚类分析</a></li>
<li class="chapter" data-level="10.4" data-path="cluster.html"><a href="cluster.html#样品间亲疏程度的测度"><i class="fa fa-check"></i><b>10.4</b> 样品间亲疏程度的测度</a></li>
<li class="chapter" data-level="10.5" data-path="cluster.html"><a href="cluster.html#类与类之间的距离"><i class="fa fa-check"></i><b>10.5</b> 类与类之间的距离</a></li>
<li class="chapter" data-level="10.6" data-path="cluster.html"><a href="cluster.html#系统聚类hierarchical-clustering-method"><i class="fa fa-check"></i><b>10.6</b> 系统聚类(hierarchical clustering method)</a></li>
<li class="chapter" data-level="10.7" data-path="cluster.html"><a href="cluster.html#快速聚类k-means-clustering-method"><i class="fa fa-check"></i><b>10.7</b> 快速聚类(k-means clustering method)</a></li>
<li class="chapter" data-level="10.8" data-path="cluster.html"><a href="cluster.html#有序聚类"><i class="fa fa-check"></i><b>10.8</b> 有序聚类</a></li>
<li class="chapter" data-level="10.9" data-path="cluster.html"><a href="cluster.html#聚类分析的主要步骤"><i class="fa fa-check"></i><b>10.9</b> 聚类分析的主要步骤</a></li>
<li class="chapter" data-level="10.10" data-path="cluster.html"><a href="cluster.html#r语言中聚类分析实现"><i class="fa fa-check"></i><b>10.10</b> R语言中聚类分析实现</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="discriminant.html"><a href="discriminant.html"><i class="fa fa-check"></i><b>11</b> Discriminant Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="discriminant.html"><a href="discriminant.html#判别分析应用"><i class="fa fa-check"></i><b>11.1</b> 判别分析应用</a></li>
<li class="chapter" data-level="11.2" data-path="discriminant.html"><a href="discriminant.html#判别分析方法"><i class="fa fa-check"></i><b>11.2</b> 判别分析方法</a><ul>
<li class="chapter" data-level="11.2.1" data-path="discriminant.html"><a href="discriminant.html#距离判别法"><i class="fa fa-check"></i><b>11.2.1</b> 距离判别法</a></li>
<li class="chapter" data-level="11.2.2" data-path="discriminant.html"><a href="discriminant.html#fisher判别法"><i class="fa fa-check"></i><b>11.2.2</b> Fisher判别法</a></li>
<li class="chapter" data-level="11.2.3" data-path="discriminant.html"><a href="discriminant.html#bayes判别法"><i class="fa fa-check"></i><b>11.2.3</b> Bayes判别法</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="discriminant.html"><a href="discriminant.html#建立判别函数的方法"><i class="fa fa-check"></i><b>11.3</b> 建立判别函数的方法</a></li>
<li class="chapter" data-level="11.4" data-path="discriminant.html"><a href="discriminant.html#判别分析的步骤及注意事项"><i class="fa fa-check"></i><b>11.4</b> 判别分析的步骤及注意事项</a></li>
<li class="chapter" data-level="11.5" data-path="discriminant.html"><a href="discriminant.html#r语言中判别分析实现"><i class="fa fa-check"></i><b>11.5</b> R语言中判别分析实现</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>12</b> Priciple Component Analysis</a><ul>
<li class="chapter" data-level="12.1" data-path="pca.html"><a href="pca.html#主成分分析基本思想"><i class="fa fa-check"></i><b>12.1</b> 主成分分析基本思想</a></li>
<li class="chapter" data-level="12.2" data-path="pca.html"><a href="pca.html#几何解释与数学模型"><i class="fa fa-check"></i><b>12.2</b> 几何解释与数学模型</a><ul>
<li class="chapter" data-level="12.2.1" data-path="pca.html"><a href="pca.html#几何解释"><i class="fa fa-check"></i><b>12.2.1</b> 几何解释</a></li>
<li class="chapter" data-level="12.2.2" data-path="pca.html"><a href="pca.html#数学模型"><i class="fa fa-check"></i><b>12.2.2</b> 数学模型</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="pca.html"><a href="pca.html#主成分的推导"><i class="fa fa-check"></i><b>12.3</b> 主成分的推导</a></li>
<li class="chapter" data-level="12.4" data-path="pca.html"><a href="pca.html#主成分的性质"><i class="fa fa-check"></i><b>12.4</b> 主成分的性质</a></li>
<li class="chapter" data-level="12.5" data-path="pca.html"><a href="pca.html#主成分分析的步骤"><i class="fa fa-check"></i><b>12.5</b> 主成分分析的步骤</a></li>
<li class="chapter" data-level="12.6" data-path="pca.html"><a href="pca.html#主成分的应用与回归"><i class="fa fa-check"></i><b>12.6</b> 主成分的应用与回归</a></li>
<li class="chapter" data-level="12.7" data-path="pca.html"><a href="pca.html#主成分分析的r语言实现"><i class="fa fa-check"></i><b>12.7</b> 主成分分析的R语言实现</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="fa.html"><a href="fa.html"><i class="fa fa-check"></i><b>13</b> Factor Analysis</a><ul>
<li class="chapter" data-level="13.1" data-path="fa.html"><a href="fa.html#因子分析概念"><i class="fa fa-check"></i><b>13.1</b> 因子分析概念</a></li>
<li class="chapter" data-level="13.2" data-path="fa.html"><a href="fa.html#因子分析模型"><i class="fa fa-check"></i><b>13.2</b> 因子分析模型</a></li>
<li class="chapter" data-level="13.3" data-path="fa.html"><a href="fa.html#因子载荷矩阵的估计方法"><i class="fa fa-check"></i><b>13.3</b> 因子载荷矩阵的估计方法</a></li>
<li class="chapter" data-level="13.4" data-path="fa.html"><a href="fa.html#因子旋转正交变换"><i class="fa fa-check"></i><b>13.4</b> 因子旋转（正交变换）</a></li>
<li class="chapter" data-level="13.5" data-path="fa.html"><a href="fa.html#因子得分"><i class="fa fa-check"></i><b>13.5</b> 因子得分</a></li>
<li class="chapter" data-level="13.6" data-path="fa.html"><a href="fa.html#因子分析步骤"><i class="fa fa-check"></i><b>13.6</b> 因子分析步骤</a></li>
<li class="chapter" data-level="13.7" data-path="fa.html"><a href="fa.html#因子分析的r语言实现"><i class="fa fa-check"></i><b>13.7</b> 因子分析的R语言实现</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="homework.html"><a href="homework.html"><i class="fa fa-check"></i><b>14</b> Case and Practice</a><ul>
<li class="chapter" data-level="14.1" data-path="homework.html"><a href="homework.html#描述性统计与抽样分布"><i class="fa fa-check"></i><b>14.1</b> 描述性统计与抽样分布</a></li>
<li class="chapter" data-level="14.2" data-path="homework.html"><a href="homework.html#参数估计与假设检验"><i class="fa fa-check"></i><b>14.2</b> 参数估计与假设检验</a></li>
<li class="chapter" data-level="14.3" data-path="homework.html"><a href="homework.html#方差分析与回归分析"><i class="fa fa-check"></i><b>14.3</b> 方差分析与回归分析</a></li>
<li class="chapter" data-level="14.4" data-path="homework.html"><a href="homework.html#作业文档"><i class="fa fa-check"></i><b>14.4</b> 作业文档</a><ul>
<li class="chapter" data-level="14.4.1" data-path="homework.html"><a href="homework.html#描述性统计与抽样分布-1"><i class="fa fa-check"></i><b>14.4.1</b> 1 描述性统计与抽样分布</a></li>
<li class="chapter" data-level="14.4.2" data-path="homework.html"><a href="homework.html#参数估计与假设检验-1"><i class="fa fa-check"></i><b>14.4.2</b> 2 参数估计与假设检验</a></li>
<li class="chapter" data-level="14.4.3" data-path="homework.html"><a href="homework.html#方差分析与回归分析-1"><i class="fa fa-check"></i><b>14.4.3</b> 3 方差分析与回归分析</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">应用统计学与R语言实现学习笔记</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="homework" class="section level1">
<h1><span class="header-section-number">第 14 章</span> Case and Practice</h1>
<p>本篇是第十四章，内容是案例与实践。这里其实是对我公选课的作业做了个汇总。</p>
<div id="描述性统计与抽样分布" class="section level2">
<h2><span class="header-section-number">14.1</span> 描述性统计与抽样分布</h2>
<p>1.一种袋装食品用生产线自动装填，每袋重量大约为50g，但由于某些原因，每袋重量不会恰好是50g。下面是随机抽取的100袋食品，测得的重量数据见附录。</p>
<p>（1）构建这些数据的频数分布表。</p>
<p>（2）绘制频数分布的直方图。</p>
<p>（3）说明数据分布的特征。</p>
<p>2.甲乙两个班各有40名学生，期末统计学考试成绩的分布见附录。</p>
<p>（1）根据上面的数据，画出两个班考试成绩的复合柱形图、环形图和图饼图。</p>
<p>（2）比较两个班考试成绩分布的特点。</p>
<p>（3）画出雷达图，比较两个班考试成绩的分布是否相似。</p>
<p>3.随机抽取25个网络用户，得到他们的年龄数据（单位：周岁）见附录。</p>
<p>（1）计算众数、中位数。</p>
<p>（2）根据定义公式计算四分位数。</p>
<p>（3）计算平均数和标准差。</p>
<p>（4）计算偏态系数和峰态系数。</p>
<p>（5）对网民年龄的分布特征进行综合分析。</p>
<p>4.某银行为缩短顾客到银行办理业务等待的时间，准备采用两种排队方式进行试验：一种是所有顾客都进入一个等待队列；另一种是顾客在三个业务窗口处列队三排等待。为比较哪种排队方式使顾客等待的时间更短，两种排队方式各随机抽取的9名顾客，得到第一中排队方式的平均等待时间为7.2分钟，标准差为，1.97分钟，第二种排队方式的等待时间（单位：min）见附录。</p>
<p>（１）画出第二种排队方式等待时间的茎叶图。</p>
<p>（２）计算第二种排队方式等待时间的平均数和标准差。</p>
<p>（３）比较两种排队方式等待时间的离散程度。
（４）如果让你选择一种排队方式，你会选择哪一种？试说明理由。</p>
<p>5.从均值为200、标准差为50的总体中，抽取n=100的简单随机样本，用样本均值`x估计总体均值。</p>
<p>a)描述重复抽样的样本均值的抽样分布。</p>
<p>b)不重复抽样，总体单位数分别为10000、1000时的样本均值的抽样分布。</p>
</div>
<div id="参数估计与假设检验" class="section level2">
<h2><span class="header-section-number">14.2</span> 参数估计与假设检验</h2>
<p>1.某大学为了解学生每天上网的时间，在全校7500名学生中采取不重复抽样方法随机抽取36人，调查他们每天上网的时间（单位：小时） ，得到的数据见附录。求该校大学生平均上网时间的置信区间，置信概率分别为90%、95%和99%。</p>
<p>2.假定两个总体的标准差分别为：<span class="math inline">\(\sigma_1=12\)</span>，<span class="math inline">\(\sigma_2=15\)</span>，若要求误差范围不超过5，相应的置信水平为95%，假定<span class="math inline">\(n_1=n_2\)</span>，估计两个总体均值之差<span class="math inline">\(m_1-m_2\)</span>时所需的样本容量为多大？</p>
<p>3.经验表明，一个矩形的宽与长之比等于0.618的时候会给人们比较良好的感觉。某工艺品工厂生产的矩形工艺品框架的宽与长要求也按这一比例设计，假定其总体服从正态分布，现随机抽取了20个框架测得比值见附录。在显著性水平 ＝0.05时，能否认为该厂生产的工艺品框架宽与长的平均比例为0.618？。</p>
<p>4.一家大型超市连锁店上个月接到许多消费者投诉某种品牌炸土豆片中60克一袋的那种土豆片的重量不符。店方猜想引起这些投诉的原因是运输过程中沉积在食品袋底部的土豆片碎屑，但为了使顾客们对花钱买到的土豆片感到物有所值，店方仍然决定对来自于一家最大的供应商的下一批袋装炸土豆片的平均重量（克）进行检验，假设陈述如下：</p>
<p><span class="math inline">\(H_0:\mu\le 60\)</span></p>
<p><span class="math inline">\(H_1:\mu&gt;60\)</span></p>
<p>如果有证据可以拒绝原假设，店方就拒收这批炸土豆片并向供应商提出投诉。</p>
<p>（1）与这一假设检验问题相关联的第一类错误是什么？</p>
<p>（2）与这一假设检验问题相关联的第二类错误是什么？</p>
<p>（3）你认为连锁店的顾客们会将哪类错误看得较为严重？而供应商会将哪类错误看得较为严重？</p>
</div>
<div id="方差分析与回归分析" class="section level2">
<h2><span class="header-section-number">14.3</span> 方差分析与回归分析</h2>
<p>1.某家电制造公司准备购进一批5#电池，现有A、B、C三个电池生产企业愿意供货，为比较它们生产的电池质量，从每个企业各随机抽取5只电池，经试验得其寿命（单位：h）数据见附录。试分析三个企业生产的电池的平均寿命之间有无显著差异（<span class="math inline">\(\alpha=0.05\)</span>）。如果有差异，用LSD方法检验哪些企业之间有差异？</p>
<p>2.一家超市连锁店的老板进行一项研究，确定超市所在的位置和竞争者的数量对销售额是否有显著影响。获得的月销售额数据（单位：万元）见附录。取显著性水平<span class="math inline">\(\alpha=0.01\)</span>，检验：</p>
<p>（1）竞争者的数量对销售额是否有显著影响。</p>
<p>（2）超市的位置对销售额是否有显著影响。</p>
<p>（3）竞争者的数量和超市的位置对销售额是否有交互影响。</p>
<p>3.附录中有随机抽取的15家大型商场销售的同类产品的有关数据（单位：元）。</p>
<p>（1）计算y与<span class="math inline">\(x_1\)</span> 、y与<span class="math inline">\(x_2\)</span>之间的相关系数，是否有证据表明销售价格与购进价格、销售价格与销售费用之间存在线性关系？</p>
<p>（2）根据上述结果，你认为用购进价格和销售费用来预测销售价格是否有用？</p>
<p>（3）用Excel进行回归，并检验模型的线性关系是否显著（<span class="math inline">\(\alpha=0.05\)</span>）。</p>
<p>（4）解释判定系数<span class="math inline">\(R^2\)</span>，所得结论与问题（2）中是否一致?</p>
<p>（5）计算<span class="math inline">\(x_1\)</span>与<span class="math inline">\(x_2\)</span>之间的相关系数，所得结果意味着什么？</p>
<p>（6）模型中是否存在多重共线性？你对模型有何建议？</p>
<p>4.附录中有32名美士足球运动员的rating及其他相关信息。请建立一个回归模型以预测一位美士足球运动员的rating。提交报告包括：使用什么方法建立的模型，该方法的运行结果，最终模型的解释（拟合程度、预测误差）。</p>
<p>这一份作业汇总从最原始的描述统计、参数估计、假设检验到基础的方差分析与回归分析均有了。根据这里的习题即可对前面的内容再次熟悉。这里就不多说了，我有一份比较完整的文档针对这份内容。</p>
</div>
<div id="作业文档" class="section level2">
<h2><span class="header-section-number">14.4</span> 作业文档</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="homework.html#cb26-1"></a><span class="co">#load library</span></span>
<span id="cb26-2"><a href="homework.html#cb26-2"></a><span class="kw">library</span>(openxlsx)</span>
<span id="cb26-3"><a href="homework.html#cb26-3"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;ggplot2&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:psych&#39;:
## 
##     %+%, alpha</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="homework.html#cb29-1"></a><span class="kw">library</span>(psych)</span>
<span id="cb29-2"><a href="homework.html#cb29-2"></a><span class="kw">library</span>(gridExtra)</span></code></pre></div>
<div id="描述性统计与抽样分布-1" class="section level3">
<h3><span class="header-section-number">14.4.1</span> 1 描述性统计与抽样分布</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>（1）频数分布表</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="homework.html#cb30-1"></a><span class="co">#Input data</span></span>
<span id="cb30-2"><a href="homework.html#cb30-2"></a><span class="kw">table</span>(a)</span></code></pre></div>
<pre><code>## a
## 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 
##  1  1  1  2  3  4  6 10  8  9  4  6  9 11  4  4  3  7  2  2  2  1</code></pre>
<p>（2）频数分布图</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="homework.html#cb32-1"></a><span class="kw">hist</span>(a<span class="op">$</span>X1, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;weight/g&quot;</span>)</span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="homework.html#cb33-1"></a>ahist&lt;-<span class="kw">ggplot</span>(a)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(a<span class="op">$</span>X1),<span class="dt">fill=</span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, <span class="dt">green =</span> <span class="dv">107</span>, <span class="dt">blue =</span> <span class="dv">200</span>, <span class="dt">max =</span> <span class="dv">255</span>),<span class="dt">binwidth=</span><span class="fl">0.5</span>,<span class="dt">stat =</span> <span class="st">&quot;bin&quot;</span>,<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;weight/g&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb33-2"><a href="homework.html#cb33-2"></a>ahist</span></code></pre></div>
<pre><code>## Warning: Use of `a$X1` is discouraged. Use `X1` instead.</code></pre>
<p><img src="bookdown_files/figure-html/r-1.png" width="672" /></p>
<p>（3）数据整体呈一个“双峰”分布。而且刚好50 g的食品非常少。大部分集中在47和53附近。</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>（1）</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="homework.html#cb35-1"></a><span class="co">#Input data and clean data</span></span>
<span id="cb35-2"><a href="homework.html#cb35-2"></a>b &lt;-<span class="st"> </span>b[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)]</span>
<span id="cb35-3"><a href="homework.html#cb35-3"></a>b &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gl =</span> b[, <span class="dv">1</span>], <span class="dt">p =</span> b[, <span class="dv">2</span>], <span class="dt">c =</span> b[, <span class="dv">3</span>])</span></code></pre></div>
<p>(2)甲班中等成绩的人最多，而优良成绩的人比不及格和及格的人少。乙班成绩为良的最多，而且不及格人数与及格人数均比甲班少。仅有中等成绩的人比甲班少，其他均多于甲班。</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p><img src="fig/fig42.png" width="100%" height="45%" /></p>
<p>甲乙两个班成绩分布差异较大。甲班中等成绩人居多，而且相比较而言，中等成绩人数量十分突出。而乙班则较为均衡，良成绩的人较少些。</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="homework.html#cb36-1"></a><span class="kw">describe</span>(c)</span></code></pre></div>
<pre><code>##    vars  n mean   sd median trimmed  mad min max range skew kurtosis   se
## X1    1 25   24 6.65     23   23.33 5.93  15  41    26 0.95     0.13 1.33</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="homework.html#cb38-1"></a><span class="kw">table</span>(c)</span></code></pre></div>
<pre><code>## c
## 15 16 17 18 19 20 21 22 23 24 25 27 29 30 31 34 38 41 
##  1  1  1  1  3  2  1  2  3  2  1  1  1  1  1  1  1  1</code></pre>
<p>（1）众数：19和23、中位数：23</p>
<p>（2）四分位数：19（上四分位数）、27（下四分位数）</p>
<p>（3）平均数：24、标准差：6.65</p>
<p>（4）偏态系数：0.95、峰态系数：0.13</p>
<p>（5）网民整体分布呈现一个右偏的尖峰分布，但是平均数与中位数较为接近。整体分布还是较为平稳。</p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="homework.html#cb40-1"></a><span class="kw">stem</span>(d[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 
##   The decimal point is at the |
## 
##   5 | 5
##   6 | 
##   6 | 678
##   7 | 134
##   7 | 88</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="homework.html#cb42-1"></a><span class="kw">summary</span>(d)</span></code></pre></div>
<pre><code>##     排队时间  
##  Min.   :5.5  
##  1st Qu.:6.7  
##  Median :7.1  
##  Mean   :7.0  
##  3rd Qu.:7.4  
##  Max.   :7.8</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="homework.html#cb44-1"></a><span class="kw">describe</span>(d)</span></code></pre></div>
<pre><code>##    vars n mean   sd median trimmed  mad min max range  skew kurtosis   se
## X1    1 9    7 0.71    7.1       7 0.59 5.5 7.8   2.3 -0.72    -0.46 0.24</code></pre>
<p>（1）
茎叶图
5 | 5
6 |
6 | 678
7 | 134
7 | 88</p>
<p>（2）平均数：7.0，标准差0.71。</p>
<p>（3）第一种方式标准差要远大于第二种方式，所以第一种方式离散程度较大。</p>
<p>（4）我会选择第二种，首先，第二种平均等待时间小于第一种，同时标准差则远小于第一种。也就是说明平均的等待时间小于第一种，同时等待时间也不会偏离7分钟太多。</p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<p>重复抽样</p>
<p><span class="math display">\[\sigma_{\bar x}^2=\frac{\sigma^2}{n}\]</span></p>
<p>（a）首先认为n=100的情况下属于大样本，可以认为近似正态分布，所以重复抽样的样本均值的抽样分布也遵循正态分布，所以样本均值抽样分布的期望值为200，方差为25</p>
<p>（样本总体有限，且<span class="math inline">\(n\ge 5\%N\)</span>不重复抽样）</p>
<p><span class="math display">\[\sigma_{\bar x}^2=\frac{\sigma^2}{n}\frac{N-n}{N-1}\]</span></p>
<p>（b）不重复抽样的样本均值的抽样分布同样遵循近似正态分布，总体样本为10000和1000时，简单随机样本的样本量n=100，5%N=500和50，所以当总体样本为10000时样本均值抽样分布的期望为为200，方差为24.75。而当总体样本仅为1000时，不满足n≥5%N的条件，可以按重复抽样计算样本均值的抽样分布：也就是期望值为200，方差为25。</p>
</div>
<div id="参数估计与假设检验-1" class="section level3">
<h3><span class="header-section-number">14.4.2</span> 2 参数估计与假设检验</h3>
<p>1.样本数<span class="math inline">\(n=36&gt;30\)</span>，可以认为大样本数据非正态分布，且总体的均值未知，因此，采用z分布计算置信区间，样本均值为3.317，标准差为1.609，置信区间计算公式为：</p>
<p><span class="math display">\[\bar x\pm z_{\alpha/2}\frac{s}{\sqrt{n}}\]</span>
分别带入计算可得。90%置信概率的置信区间为[2.863,3.770]，95%置信概率的置信区间为[2.772,3.861]，99%置信概率的置信区间为[2.586,4.047]。</p>
<p>2.总体均值之差估计（且n1=n2，总体标准差已知）所需样本容量的公式为：</p>
<p><span class="math display">\[n=\frac{(z_{\alpha/2})^2\cdot(\sigma_1^2+\sigma_2^2)}{E^2}\]</span></p>
<p>其中<span class="math inline">\(E=z_{\alpha/2}\sqrt{\frac{(\sigma_1^2+\sigma_2^2)}{n}}\)</span>，误差范围不超过5，即将E=5带入，即可得到n的最小值，即n=56.700，即n=57。</p>
<p>3.假设<span class="math inline">\(H_0: \mu=0.618\)</span>，备择假设<span class="math inline">\(H_1: \mu≠0.618\)</span>。该问题为总体方差未知的正态小样本均值检验。故选用t分布检验统计量。</p>
<p><span class="math display">\[t=\frac{\bar x-\mu_0}{s/\sqrt{n}}\sim t(n-1)\]</span></p>
<p>可以得到t=1.932318，而显著性水平<span class="math inline">\(\alpha=0.05\)</span>的t分布临界值为2.093024。因为t＜2.093024，所以拒绝<span class="math inline">\(H_0\)</span>，无法认为该工厂生产的工艺品框架宽与长度的平均比例为0.618。</p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>（1）第一类错误是弃真错误，也就是原假设为真，却拒绝了原假设。</p>
<p>（2）第二类错误是取伪错误，也就是原假设为假，但未拒绝原假设。</p>
<p>（3）连锁店的顾客们会将取伪错误看得较为严重，因为顾客肯定希望能获得更多的利益，也就是说希望土豆片比60克多，如果商家检验结果是取伪错误——就是事实上，土豆片不到60克，但是检验结果却是大于60克。而供应商则会将弃真错误看得较为严重，因为对供应商来说，土豆片少一点，相当于材料费少了些，对于他们收益是好的，所以他们希望的是土豆片比60克少或者刚好60克，如果商家检验结果是弃真错误——就是事实上，土豆片是大于60克的，但是检验结果却是小于60克。</p>
<p>相关代码及自编假设检验函数。</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="homework.html#cb46-1"></a><span class="kw">mean</span>(a[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 3.316667</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="homework.html#cb48-1"></a><span class="kw">sd</span>(a[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1.609348</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="homework.html#cb50-1"></a><span class="co">#方差已知的区间估计</span></span>
<span id="cb50-2"><a href="homework.html#cb50-2"></a>conf.int =<span class="st"> </span><span class="cf">function</span>(x, sigma, alpha) {</span>
<span id="cb50-3"><a href="homework.html#cb50-3"></a>  mean =<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb50-4"><a href="homework.html#cb50-4"></a>  n =<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb50-5"><a href="homework.html#cb50-5"></a>  z =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> T)</span>
<span id="cb50-6"><a href="homework.html#cb50-6"></a>  <span class="kw">c</span>(mean<span class="op">-</span>sigma<span class="op">*</span>z<span class="op">/</span><span class="kw">sqrt</span>(n), mean <span class="op">+</span><span class="st"> </span>sigma<span class="op">*</span>z<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb50-7"><a href="homework.html#cb50-7"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="homework.html#cb51-1"></a><span class="co">#方差未知的区间估计</span></span>
<span id="cb51-2"><a href="homework.html#cb51-2"></a><span class="kw">t.test</span>(a, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">conf.level =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  a
## t = 12.365, df = 35, p-value = 2.491e-14
## alternative hypothesis: true mean is not equal to 0
## 90 percent confidence interval:
##  2.863482 3.769852
## sample estimates:
## mean of x 
##  3.316667</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="homework.html#cb53-1"></a><span class="kw">t.test</span>(a, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  a
## t = 12.365, df = 35, p-value = 2.491e-14
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  2.772142 3.861192
## sample estimates:
## mean of x 
##  3.316667</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="homework.html#cb55-1"></a><span class="kw">t.test</span>(a, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">conf.level =</span> <span class="fl">0.99</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  a
## t = 12.365, df = 35, p-value = 2.491e-14
## alternative hypothesis: true mean is not equal to 0
## 99 percent confidence interval:
##  2.586075 4.047258
## sample estimates:
## mean of x 
##  3.316667</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="homework.html#cb57-1"></a><span class="co">#样本容量</span></span>
<span id="cb57-2"><a href="homework.html#cb57-2"></a><span class="co">#sample number function</span></span>
<span id="cb57-3"><a href="homework.html#cb57-3"></a>samplemin.int =<span class="st"> </span><span class="cf">function</span>(sigma1, sigma2, error, alpha) {</span>
<span id="cb57-4"><a href="homework.html#cb57-4"></a>  z =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> T)</span>
<span id="cb57-5"><a href="homework.html#cb57-5"></a>  n =<span class="st"> </span>z<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(sigma1<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>sigma2<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>error<span class="op">^</span><span class="dv">2</span></span>
<span id="cb57-6"><a href="homework.html#cb57-6"></a>  <span class="kw">cat</span>(<span class="st">&quot;The number of Sample is more than&quot;</span>, n)</span>
<span id="cb57-7"><a href="homework.html#cb57-7"></a>}</span>
<span id="cb57-8"><a href="homework.html#cb57-8"></a><span class="co">#function calculated</span></span>
<span id="cb57-9"><a href="homework.html#cb57-9"></a><span class="kw">samplemin.int</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">5</span>, <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## The number of Sample is more than 56.69993</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="homework.html#cb59-1"></a><span class="co">#function meantest</span></span>
<span id="cb59-2"><a href="homework.html#cb59-2"></a>meantest.int =<span class="st"> </span><span class="cf">function</span>(x, meanpop, sigmapop, alpha, <span class="dt">pop =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb59-3"><a href="homework.html#cb59-3"></a>  mean =<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb59-4"><a href="homework.html#cb59-4"></a>  sd =<span class="st"> </span><span class="kw">sd</span>(x)</span>
<span id="cb59-5"><a href="homework.html#cb59-5"></a>  n =<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb59-6"><a href="homework.html#cb59-6"></a>  t0 =<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>, <span class="dt">lower.tail =</span> T)</span>
<span id="cb59-7"><a href="homework.html#cb59-7"></a>  z0 =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> T)</span>
<span id="cb59-8"><a href="homework.html#cb59-8"></a>  <span class="cf">if</span> (pop) {</span>
<span id="cb59-9"><a href="homework.html#cb59-9"></a>    p =<span class="st"> </span>(mean<span class="op">-</span>meanpop)<span class="op">/</span>(sigmapop<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb59-10"><a href="homework.html#cb59-10"></a>    status =<span class="st"> </span>p<span class="op">-</span>z0</span>
<span id="cb59-11"><a href="homework.html#cb59-11"></a>  } <span class="cf">else</span> {</span>
<span id="cb59-12"><a href="homework.html#cb59-12"></a>    sigmapop =<span class="st"> </span>sd</span>
<span id="cb59-13"><a href="homework.html#cb59-13"></a>    p =<span class="st"> </span>(mean<span class="op">-</span>meanpop)<span class="op">/</span>(sigmapop<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb59-14"><a href="homework.html#cb59-14"></a>    status =<span class="st"> </span>p<span class="op">-</span>t0</span>
<span id="cb59-15"><a href="homework.html#cb59-15"></a>  }</span>
<span id="cb59-16"><a href="homework.html#cb59-16"></a>  <span class="kw">cat</span>(<span class="st">&quot;Hypothesis Test:&quot;</span>, status <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb59-17"><a href="homework.html#cb59-17"></a>}</span>
<span id="cb59-18"><a href="homework.html#cb59-18"></a><span class="co">#function calculated</span></span>
<span id="cb59-19"><a href="homework.html#cb59-19"></a><span class="kw">meantest.int</span>(b[,<span class="dv">1</span>], <span class="fl">0.618</span>, <span class="dv">1</span>, <span class="fl">0.05</span>, <span class="dt">pop =</span> F)</span></code></pre></div>
<pre><code>## Hypothesis Test: FALSE</code></pre>
</div>
<div id="方差分析与回归分析-1" class="section level3">
<h3><span class="header-section-number">14.4.3</span> 3 方差分析与回归分析</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="homework.html#cb61-1"></a><span class="co">#load library</span></span>
<span id="cb61-2"><a href="homework.html#cb61-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb61-3"><a href="homework.html#cb61-3"></a><span class="kw">library</span>(openxlsx)</span>
<span id="cb61-4"><a href="homework.html#cb61-4"></a><span class="kw">library</span>(psych)</span>
<span id="cb61-5"><a href="homework.html#cb61-5"></a><span class="kw">library</span>(corrplot)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="homework.html#cb62-1"></a><span class="co">#question1</span></span>
<span id="cb62-2"><a href="homework.html#cb62-2"></a><span class="co">#variance analysis</span></span>
<span id="cb62-3"><a href="homework.html#cb62-3"></a>a.aov &lt;-<span class="st"> </span><span class="kw">aov</span>(battery<span class="op">~</span>company, <span class="dt">data =</span> a)</span>
<span id="cb62-4"><a href="homework.html#cb62-4"></a><span class="kw">summary</span>(a.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## company      2  615.6  307.80   17.07 0.00031 ***
## Residuals   12  216.4   18.03                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>根据方差分析结果，三个企业生产的电池的平均寿命之间有显著差异。根据LSD方法进行检验。LSD检验统计量公式如下：</p>
<p><span class="math display">\[LSD=t_{\alpha/2}\sqrt{MSE(\frac{1}{n_i}+\frac{1}{n_j})}\]</span></p>
<p>带入计算可得，LSD=5.760。然后可以计算可得：</p>
<p><span class="math inline">\(|\mu A-\mu B|=14.4&gt;5.760\)</span>，<span class="math inline">\(|\mu A-\mu C|=1.8&lt;5.760\)</span>，<span class="math inline">\(|\mu B-\mu C|=12.6&gt;5.760\)</span>。</p>
<p>所以A企业和B企业，B企业和C企业之间是有差异的。</p>
<p>2.本问题为双因素的问题，所以采用双因子方差分析结果（分别选用的无交互作用和有交互作用的）如下：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="homework.html#cb64-1"></a><span class="co">#Input data</span></span>
<span id="cb64-2"><a href="homework.html#cb64-2"></a><span class="co">#no interaction</span></span>
<span id="cb64-3"><a href="homework.html#cb64-3"></a>b.aov &lt;-<span class="st"> </span><span class="kw">aov</span>(value<span class="op">~</span>location<span class="op">+</span>competition, <span class="dt">data =</span> b)</span>
<span id="cb64-4"><a href="homework.html#cb64-4"></a><span class="kw">summary</span>(b.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## location     2   1736   868.1  23.448 7.38e-07 ***
## competition  3   1078   359.4   9.709 0.000123 ***
## Residuals   30   1111    37.0                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="homework.html#cb66-1"></a><span class="co">#interaction</span></span>
<span id="cb66-2"><a href="homework.html#cb66-2"></a>bi.aov &lt;-<span class="st"> </span><span class="kw">aov</span>(value<span class="op">~</span>location<span class="op">*</span>competition, <span class="dt">data =</span> b)</span>
<span id="cb66-3"><a href="homework.html#cb66-3"></a><span class="kw">summary</span>(bi.aov)</span></code></pre></div>
<pre><code>##                      Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## location              2 1736.2   868.1  34.305 9.18e-08 ***
## competition           3 1078.3   359.4  14.204 1.57e-05 ***
## location:competition  6  503.3    83.9   3.315   0.0161 *  
## Residuals            24  607.3    25.3                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>（1）从双因素方差分析的结果来看，F统计值通过了0.001大于设定的显著性水平的显著性检验，可以认为竞争者的数量对销售额有显著影响。</p>
<p>（2）从双因素方差分析的结果来看，F统计值通过了0.001大于设定的显著性水平的显著性检验，可以认为超市的位置对销售额有显著影响。</p>
<p>（3）从双因素方差分析的结果来看，F统计值通过了0.05小于设定的显著性水平的显著性检验，可以认为竞争者的数量和超市的位置对销售额无交互影响。</p>
<p>3.（1）<span class="math inline">\(r_{y,x1}\)</span>=0.309，<span class="math inline">\(r_{y,x2}\)</span>=0.01。并绘制了散点图，从相关系数来看，y与<span class="math inline">\(x_1\)</span>有线性关系，y与<span class="math inline">\(x_2\)</span>无线性关系。几何散点图来看，二者的线性关系也不是非常显著。</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="homework.html#cb68-1"></a><span class="kw">cor</span>(c[,<span class="dv">2</span>], c[,<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## [1] 0.3089521</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="homework.html#cb70-1"></a><span class="kw">cor</span>(c[,<span class="dv">2</span>], c[,<span class="dv">4</span>])</span></code></pre></div>
<pre><code>## [1] 0.001214062</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="homework.html#cb72-1"></a><span class="kw">layout</span>((<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">byrow =</span> T)))</span>
<span id="cb72-2"><a href="homework.html#cb72-2"></a><span class="kw">plot</span>(c[,<span class="dv">2</span>], c[,<span class="dv">3</span>])</span>
<span id="cb72-3"><a href="homework.html#cb72-3"></a><span class="kw">plot</span>(c[,<span class="dv">2</span>], c[,<span class="dv">4</span>])</span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
<p>（2）用购进价格来预测销售价格可能更有用，销售费用对销售价格影响较小。</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="homework.html#cb73-1"></a>c.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> c[,<span class="dv">2</span>]<span class="op">~</span>c[,<span class="dv">3</span>]<span class="op">+</span>c[,<span class="dv">4</span>])</span>
<span id="cb73-2"><a href="homework.html#cb73-2"></a><span class="kw">summary</span>(c.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = c[, 2] ~ c[, 3] + c[, 4])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -189.02  -25.69   17.89   44.16   64.90 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 375.6018   339.4106   1.107   0.2901  
## c[, 3]        0.5378     0.2104   2.556   0.0252 *
## c[, 4]        1.4572     0.6677   2.182   0.0497 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 69.75 on 12 degrees of freedom
## Multiple R-squared:  0.3525, Adjusted R-squared:  0.2445 
## F-statistic: 3.266 on 2 and 12 DF,  p-value: 0.07372</code></pre>
<p>（3）从F检验统计值来看，P值通过了0.1的显著性水平检验，与题目所要求的0.05不符合。所以模型的线性关系不显著。</p>
<p>（4）判定系数<span class="math inline">\(R^2\)</span>为0.352，说明销售价格变动的35%是由购进价格和销售费用决定的。线性关系较弱。</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="homework.html#cb75-1"></a><span class="kw">cor</span>(c[,<span class="dv">3</span>], c[,<span class="dv">4</span>])</span></code></pre></div>
<pre><code>## [1] -0.8528576</code></pre>
<p>（5）<span class="math inline">\(r_{x1,x2}\)</span>=-0.853，说明购进价格与销售费用呈现负相关的关系。</p>
<p>（6）模型存在多重共线性，建议使用逐步回归方法去除变量进行回归分析。</p>
<ol start="4" style="list-style-type: decimal">
<li>首先对变量进行相关分析。</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="homework.html#cb77-1"></a>dcor &lt;-<span class="st"> </span><span class="kw">corr.test</span>(d[, <span class="kw">c</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">13</span>)])</span>
<span id="cb77-2"><a href="homework.html#cb77-2"></a>dcorp &lt;-<span class="st"> </span>dcor<span class="op">$</span>p</span>
<span id="cb77-3"><a href="homework.html#cb77-3"></a>dcorp[<span class="kw">upper.tri</span>(dcorp)]=<span class="dv">0</span></span>
<span id="cb77-4"><a href="homework.html#cb77-4"></a><span class="kw">corrplot.mixed</span>(dcor<span class="op">$</span>r, <span class="dt">lower =</span> <span class="st">&quot;number&quot;</span>, <span class="dt">upper =</span> <span class="st">&quot;circle&quot;</span>, <span class="dt">diag =</span> <span class="st">&quot;u&quot;</span>,</span>
<span id="cb77-5"><a href="homework.html#cb77-5"></a>               <span class="dt">tl.pos =</span> <span class="st">&quot;lt&quot;</span>, <span class="dt">tl.cex =</span> <span class="fl">0.8</span>, <span class="dt">number.cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb77-6"><a href="homework.html#cb77-6"></a>               <span class="dt">p.mat =</span> dcorp, <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="dt">insig =</span> <span class="kw">c</span>(<span class="st">&quot;blank&quot;</span>))</span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<p>可以发现Rating跟Comp、Comp%，Yds，Yds/Att，TD，TD%和Int%有显著的相关关系，且相关系数均在0.48以上。
接下来绘制Rating跟其余10个指标的散点图。</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="homework.html#cb78-1"></a><span class="kw">layout</span>((<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> T)))</span>
<span id="cb78-2"><a href="homework.html#cb78-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span><span class="dv">12</span>) {</span>
<span id="cb78-3"><a href="homework.html#cb78-3"></a>  <span class="kw">plot</span>(d[,<span class="kw">c</span>(i)], d[,<span class="kw">c</span>(<span class="dv">13</span>)], <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</span>
<span id="cb78-4"><a href="homework.html#cb78-4"></a>}</span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<p>可以看到与其他10个指标的散点图，线性关系也较为显著。根据相关系数矩阵结果和散点图，选定7个自变量进行逐步回归。结果如下：</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="homework.html#cb79-1"></a>d.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula=</span>d<span class="op">$</span>Rating<span class="op">~</span>d<span class="op">$</span>Comp<span class="op">+</span>d<span class="op">$</span><span class="st">`</span><span class="dt">Comp%</span><span class="st">`</span><span class="op">+</span>d<span class="op">$</span>Yds<span class="op">+</span>d<span class="op">$</span><span class="st">`</span><span class="dt">Yds/Att</span><span class="st">`</span><span class="op">+</span>d<span class="op">$</span>TD<span class="op">+</span>d<span class="op">$</span><span class="st">`</span><span class="dt">TD%</span><span class="st">`</span><span class="op">+</span>d<span class="op">$</span><span class="st">`</span><span class="dt">Int%</span><span class="st">`</span>)</span>
<span id="cb79-2"><a href="homework.html#cb79-2"></a><span class="kw">summary</span>(d.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = d$Rating ~ d$Comp + d$`Comp%` + d$Yds + d$`Yds/Att` + 
##     d$TD + d$`TD%` + d$`Int%`)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.44418 -0.10043 -0.01134  0.07179  0.45795 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.8195100  0.9227453   0.888    0.383    
## d$Comp      -0.0096770  0.0127657  -0.758    0.456    
## d$`Comp%`    0.8824402  0.0580504  15.201 8.12e-14 ***
## d$Yds        0.0007261  0.0011967   0.607    0.550    
## d$`Yds/Att`  3.9934242  0.4803831   8.313 1.59e-08 ***
## d$TD         0.0053251  0.0412568   0.129    0.898    
## d$`TD%`      3.2613349  0.1736048  18.786 7.38e-16 ***
## d$`Int%`    -4.1156277  0.0552894 -74.438  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2107 on 24 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9996 
## F-statistic: 1.073e+04 on 7 and 24 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="homework.html#cb81-1"></a>d.lms &lt;-<span class="st"> </span><span class="kw">step</span>(d.lm)</span></code></pre></div>
<pre><code>## Start:  AIC=-92.86
## d$Rating ~ d$Comp + d$`Comp%` + d$Yds + d$`Yds/Att` + d$TD + 
##     d$`TD%` + d$`Int%`
## 
##               Df Sum of Sq     RSS     AIC
## - d$TD         1     0.001   1.067 -94.841
## - d$Yds        1     0.016   1.082 -94.376
## - d$Comp       1     0.026   1.091 -94.106
## &lt;none&gt;                       1.066 -92.863
## - d$`Yds/Att`  1     3.069   4.135 -51.481
## - d$`Comp%`    1    10.262  11.328 -19.230
## - d$`TD%`      1    15.673  16.739  -6.736
## - d$`Int%`     1   246.077 247.142  79.415
## 
## Step:  AIC=-94.84
## d$Rating ~ d$Comp + d$`Comp%` + d$Yds + d$`Yds/Att` + d$`TD%` + 
##     d$`Int%`
## 
##               Df Sum of Sq     RSS     AIC
## - d$Yds        1     0.035   1.102 -95.800
## - d$Comp       1     0.040   1.106 -95.669
## &lt;none&gt;                       1.067 -94.841
## - d$`Yds/Att`  1     5.126   6.193 -40.555
## - d$`Comp%`    1    13.339  14.405 -13.541
## - d$`TD%`      1   185.958 187.024  68.496
## - d$`Int%`     1   248.858 249.925  77.774
## 
## Step:  AIC=-95.8
## d$Rating ~ d$Comp + d$`Comp%` + d$`Yds/Att` + d$`TD%` + d$`Int%`
## 
##               Df Sum of Sq    RSS     AIC
## - d$Comp       1      0.03   1.14 -96.806
## &lt;none&gt;                       1.10 -95.800
## - d$`Yds/Att`  1     77.60  78.70  38.797
## - d$`Comp%`    1    132.45 133.55  55.719
## - d$`TD%`      1    191.93 193.03  67.508
## - d$`Int%`     1    318.97 320.08  83.690
## 
## Step:  AIC=-96.81
## d$Rating ~ d$`Comp%` + d$`Yds/Att` + d$`TD%` + d$`Int%`
## 
##               Df Sum of Sq    RSS     AIC
## &lt;none&gt;                       1.14 -96.806
## - d$`Yds/Att`  1     79.79  80.92  37.688
## - d$`Comp%`    1    145.56 146.69  56.724
## - d$`TD%`      1    210.59 211.73  68.467
## - d$`Int%`     1    319.64 320.77  81.760</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="homework.html#cb83-1"></a><span class="kw">summary</span>(d.lms)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = d$Rating ~ d$`Comp%` + d$`Yds/Att` + d$`TD%` + d$`Int%`)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.46142 -0.10795 -0.01766  0.10111  0.42857 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.22654    0.79856   1.536    0.136    
## d$`Comp%`    0.83826    0.01426  58.802   &lt;2e-16 ***
## d$`Yds/Att`  4.28174    0.09835  43.535   &lt;2e-16 ***
## d$`TD%`      3.27642    0.04632  70.729   &lt;2e-16 ***
## d$`Int%`    -4.13490    0.04745 -87.137   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2052 on 27 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9996 
## F-statistic: 1.98e+04 on 4 and 27 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>可以看到逐步回归结果只保留了4个自变量（Comp%，Yds/Att，TD%，Int%），模型的<span class="math inline">\(R^2\)</span>达到了1.000。说明美式足球员的Ranting变化的100%能够被如上的四个变量进行解释。标准残差为0.205。说明预测精度非常高，残差较小，而F统计值通过了0.01的显著性检验。说明该预测方程可信度较高。</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fa.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-chinese/edit/master/14-homework.Rmd",
"text": "编辑"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
